"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var express = require("express");
var router = express.Router();
var sensor_data_1 = require("../models/sensor-data");
var usb_sensor_manager_1 = require("../models/usb-sensor-manager");
var logger_1 = require("./../logger");
router.get('/', function (_req, res) {
    var sensorLogger = usb_sensor_manager_1.USBSensorManager.getLoggers()
        .find(function (logger) { return logger.getState !== undefined; });
    var data = new sensor_data_1.SensorData();
    if (sensorLogger && sensorLogger.getState()) {
        var sensorData = sensorLogger.getState().getSensorData();
        logger_1.log.debug('--- / get, state: ', sensorLogger.getState());
        logger_1.log.debug('--- / get, data:', sensorData);
        Object.assign(data, sensorData);
    }
    res.render('index', {
        title: 'Temperatur',
        port0: data.getPort(),
        value0: data.getValue(),
        date0: new Date(data.timestamp()).toTimeString(),
    });
});
exports.default = router;

//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9yb3V0ZXMvaW5kZXgudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFHQSxpQ0FBb0M7QUFDcEMsSUFBTSxNQUFNLEdBQW1CLE9BQU8sQ0FBQyxNQUFNLEVBQUUsQ0FBQztBQUNoRCxxREFBbUQ7QUFFbkQsbUVBQWdFO0FBRWhFLHNDQUFrQztBQUVsQyxNQUFNLENBQUMsR0FBRyxDQUFDLEdBQUcsRUFBRSxVQUFDLElBQXFCLEVBQUUsR0FBcUI7SUFFekQsSUFBTSxZQUFZLEdBQUcscUNBQWdCLENBQUMsVUFBVSxFQUFFO1NBQzdDLElBQUksQ0FBQyxVQUFBLE1BQU0sSUFBRyxPQUFBLE1BQU0sQ0FBQyxRQUFRLEtBQUssU0FBUyxFQUE3QixDQUE2QixDQUFDLENBQUM7SUFFbEQsSUFBTSxJQUFJLEdBQWUsSUFBSSx3QkFBVSxFQUFFLENBQUM7SUFFMUMsSUFBSSxZQUFZLElBQUksWUFBWSxDQUFDLFFBQVEsRUFBRSxFQUFFO1FBQ3pDLElBQU0sVUFBVSxHQUFHLFlBQVksQ0FBQyxRQUFRLEVBQUUsQ0FBQyxhQUFhLEVBQUUsQ0FBQztRQUMzRCxZQUFHLENBQUMsS0FBSyxDQUFDLG9CQUFvQixFQUFFLFlBQVksQ0FBQyxRQUFRLEVBQUUsQ0FBQyxDQUFDO1FBQ3pELFlBQUcsQ0FBQyxLQUFLLENBQUMsa0JBQWtCLEVBQUMsVUFBVSxDQUFDLENBQUM7UUFDekMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxJQUFJLEVBQUUsVUFBVSxDQUFDLENBQUM7S0FDbkM7SUFHRCxHQUFHLENBQUMsTUFBTSxDQUFDLE9BQU8sRUFBRTtRQUNoQixLQUFLLEVBQUUsWUFBWTtRQUNuQixLQUFLLEVBQUUsSUFBSSxDQUFDLE9BQU8sRUFBRTtRQUNyQixNQUFNLEVBQUUsSUFBSSxDQUFDLFFBQVEsRUFBRTtRQUN2QixLQUFLLEVBQUUsSUFBSSxJQUFJLENBQUMsSUFBSSxDQUFDLFNBQVMsRUFBRSxDQUFDLENBQUMsWUFBWSxFQUFFO0tBQ25ELENBQUMsQ0FBQztBQUNQLENBQUMsQ0FBQyxDQUFDO0FBRUgsa0JBQWUsTUFBTSxDQUFDIiwiZmlsZSI6InJvdXRlcy9pbmRleC5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qXHJcbiAqIEdFVCBob21lIHBhZ2UuXHJcbiAqL1xyXG5pbXBvcnQgZXhwcmVzcyA9IHJlcXVpcmUoJ2V4cHJlc3MnKTtcclxuY29uc3Qgcm91dGVyOiBleHByZXNzLlJvdXRlciA9IGV4cHJlc3MuUm91dGVyKCk7XHJcbmltcG9ydCB7IFNlbnNvckRhdGEgfSBmcm9tICcuLi9tb2RlbHMvc2Vuc29yLWRhdGEnO1xyXG5cclxuaW1wb3J0IHsgVVNCU2Vuc29yTWFuYWdlciB9IGZyb20gJy4uL21vZGVscy91c2Itc2Vuc29yLW1hbmFnZXInO1xyXG5cclxuaW1wb3J0IHsgbG9nIH0gZnJvbSAnLi8uLi9sb2dnZXInO1xyXG5cclxucm91dGVyLmdldCgnLycsIChfcmVxOiBleHByZXNzLlJlcXVlc3QsIHJlczogZXhwcmVzcy5SZXNwb25zZSkgPT4ge1xyXG5cclxuICAgIGNvbnN0IHNlbnNvckxvZ2dlciA9IFVTQlNlbnNvck1hbmFnZXIuZ2V0TG9nZ2VycygpXHJcbiAgICAgICAgLmZpbmQobG9nZ2VyPT4gbG9nZ2VyLmdldFN0YXRlICE9PSB1bmRlZmluZWQpO1xyXG5cclxuICAgIGNvbnN0IGRhdGE6IFNlbnNvckRhdGEgPSBuZXcgU2Vuc29yRGF0YSgpO1xyXG5cclxuICAgIGlmIChzZW5zb3JMb2dnZXIgJiYgc2Vuc29yTG9nZ2VyLmdldFN0YXRlKCkpIHtcclxuICAgICAgICBjb25zdCBzZW5zb3JEYXRhID0gc2Vuc29yTG9nZ2VyLmdldFN0YXRlKCkuZ2V0U2Vuc29yRGF0YSgpO1xyXG4gICAgICAgIGxvZy5kZWJ1ZygnLS0tIC8gZ2V0LCBzdGF0ZTogJywgc2Vuc29yTG9nZ2VyLmdldFN0YXRlKCkpO1xyXG4gICAgICAgIGxvZy5kZWJ1ZygnLS0tIC8gZ2V0LCBkYXRhOicsc2Vuc29yRGF0YSk7XHJcbiAgICAgICAgT2JqZWN0LmFzc2lnbihkYXRhLCBzZW5zb3JEYXRhKTtcclxuICAgIH1cclxuXHJcblxyXG4gICAgcmVzLnJlbmRlcignaW5kZXgnLCB7XHJcbiAgICAgICAgdGl0bGU6ICdUZW1wZXJhdHVyJyxcclxuICAgICAgICBwb3J0MDogZGF0YS5nZXRQb3J0KCksXHJcbiAgICAgICAgdmFsdWUwOiBkYXRhLmdldFZhbHVlKCksXHJcbiAgICAgICAgZGF0ZTA6IG5ldyBEYXRlKGRhdGEudGltZXN0YW1wKCkpLnRvVGltZVN0cmluZygpLFxyXG4gICAgfSk7XHJcbn0pO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgcm91dGVyO1xyXG4iXX0=
