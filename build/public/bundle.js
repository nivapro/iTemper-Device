(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){
init();
function init() {
    initMenu();
    openSection('sensorSection');
    const monitorBtn = document.getElementById('monitor');
    on('click', monitorBtn, () => { monitor(); });
}
function initMenu() {
    const menu = document.getElementById('menu');
    console.log('initMenu()');
    menu.appendChild(menuItem('Sensors', 'sensorSection'));
    menu.appendChild(menuItem('Settings', 'settingsSection'));
}
function menuItem(name, sectionId) {
    console.log('menuItem: name=%s, sectionId=%s', name, sectionId);
    const li = document.createElement('li');
    const a = document.createElement('a');
    a.innerHTML = name;
    on('click', a, () => { openSection(sectionId); });
    li.appendChild(a);
    return li;
}
function on(event, element, fn) {
    if (element) {
        console.log('on %s: add event listener', event);
        element.addEventListener(event, fn);
    }
}
function openSection(id) {
    console.log('openSection: ', id);
    closeActiveSections();
    const section = document.getElementById(id);
    if (section) {
        console.log('openSection: %s', id);
        section.style.display = 'block';
        section.classList.add('active');
    }
    else {
        console.log('openSection: section %s not found', id);
    }
}
function closeActiveSections() {
    const activeItems = document.getElementsByClassName('active');
    for (let index = 0; index < activeItems.length; index++) {
        const section = activeItems[index];
        section.classList.remove('active');
        section.setAttribute('style', 'display:none');
    }
}
const sensors = [];
// let settings = [];
const url = 'ws://' + document.domain;
let socket = new WebSocket(url);
socket.onopen = function () {
    setConnectionStatus(true);
    socket.send(JSON.stringify({ command: 'getSensors' }));
    socket.send(JSON.stringify({ command: 'getSettings' }));
};
socket.onmessage = function (event) {
    setConnectionStatus(true);
    const msg = JSON.parse(event.data);
    switch (msg.command) {
        case 'sensors':
            receiveSensors(msg.data);
            if (!isMonitoring) {
                startMonitor(sensors);
            }
            break;
        case 'settings':
            receiveSettings(msg.data);
            break;
        case 'log':
            log(msg.data);
            break;
    }
};
socket.onclose = function () {
    setConnectionStatus(false);
    clearTimeout(logTimer);
    logTimer = setInterval(clearSensorValue, 5000);
};
socket.onerror = function () {
    setConnectionStatus(false);
    clearTimeout(logTimer);
    logTimer = setInterval(clearSensorValue, 5000);
};
function sensorName(desc) {
    return desc.SN + ', port ' + desc.port;
}
function sensorId(desc) {
    const sn = desc.SN.replace(' ', desc.SN);
    const id = desc.SN.replace(' ', desc.SN) + '-' + desc.port;
    return id;
}
function receiveSensors(sensors) {
    const section = document.getElementById('sensorSection');
    for (const sensor of sensors) {
        const article = document.createElement('article');
        const heading = document.createElement('h3');
        heading.id = sensorId(sensor.desc) + '-value';
        article.appendChild(heading);
        const desc = document.createElement('p');
        desc.id = sensorId(sensor.desc);
        article.appendChild(desc);
        if (section) {
            section.appendChild(article);
        }
    }
    log(sensors);
}
let isMonitoring = false;
function setMonitoringButton() {
    const button = document.getElementById('monitor');
    if (!button) {
        return;
    }
    if (isMonitoring) {
        button.innerHTML = 'Stop monitor';
        button.classList.add('isMonitoring');
    }
    else {
        button.innerHTML = 'Start Monitor';
        button.classList.remove('isMonitoring');
    }
}
function startMonitor(sensors) {
    isMonitoring = true;
    setMonitoringButton();
    const command = 'startMonitor';
    const data = [];
    for (const sensor of sensors) {
        data.push(sensor.desc);
    }
    socket.send(JSON.stringify({ command, data }));
}
function stopMonitor(sensors) {
    isMonitoring = false;
    setMonitoringButton();
    const command = 'stopMonitor';
    const data = [];
    for (const sensor of sensors) {
        data.push(sensor.desc);
    }
    socket.send(JSON.stringify({ command, data }));
}
let logTimer;
function log(sensorData) {
    for (const sensor of sensorData) {
        const log = document.getElementById(sensorId(sensor.desc) + '-value');
        if (log) {
            const date = new Date(sensor.samples[0].date);
            const value = sensor.samples[0].value;
            log.innerHTML = value + ' °C';
        }
        const desc = document.getElementById(sensorId(sensor.desc));
        if (desc) {
            const date = new Date(sensor.samples[0].date);
            const value = sensor.samples[0].value;
            desc.innerHTML = 'by ' + sensorName(sensor.desc) + ': ' +
                date.toLocaleDateString() + ', ' + date.toLocaleTimeString();
        }
        clearTimeout(logTimer);
        logTimer = setInterval(clearSensorValue, 3000);
    }
}
class HTMLSetting {
    constructor(setting) {
        this.name = setting.name;
        this.label = setting.label;
        this.value = setting.value;
        this.defaultValue = setting.defaultValue;
        this.text = setting.text;
        this.readonly = setting.readonly;
        this.input = document.getElementById(name + 'value');
        this.backstore = this.value.toString();
        this.editBtn = document.getElementById(name + 'edit');
        this.SaveBtn = document.getElementById(name + 'save');
    }
    static create(setting) {
        if (!HTMLSetting.has(setting.name)) {
            const newSetting = new HTMLSetting(setting);
            HTMLSetting.settings.push(newSetting);
            return newSetting;
        }
        else {
            console.error('HTMLSetting.create: setting exists ', setting.name);
            throw Error();
        }
    }
    static find(name) {
        for (const setting of HTMLSetting.settings) {
            if (setting.name === name) {
                return setting;
            }
        }
        console.error('Setting.find: setting "%s" not found', name);
        console.log('HTMLSetting.get: length=', HTMLSetting.settings.length);
        throw Error();
    }
    static has(name) {
        for (const setting of HTMLSetting.settings) {
            if (setting.name === name) {
                return true;
            }
        }
        return false;
    }
    editSetting() {
        this.backstore = this.input.value;
        this.input.readOnly = true;
        this.input.classList.remove('settingReadonly');
        this.input.classList.add('settingEdit');
        this.editBtn.innerHTML = 'Avbryt';
        this.editBtn.classList.remove('settingReadonly');
        this.editBtn.classList.add('settingEdit');
        this.SaveBtn.setAttribute('style', 'display:block');
    }
    readonlySetting() {
        this.input.value = this.backstore;
        this.input.readOnly = false;
        this.input.classList.remove('settingEdit');
        this.input.classList.add('settingReadonly');
        this.editBtn.innerHTML = 'Ändra';
        this.editBtn.classList.remove('settingEdit');
        this.editBtn.classList.add('settingReadonly');
        this.SaveBtn.setAttribute('style', 'display:none');
    }
    saveSetting() {
        if (this.backstore !== this.input.value) {
            this.backstore = this.input.value;
        }
        this.readonlySetting();
    }
}
HTMLSetting.settings = [];
function addSetting(setting, section) {
    console.log('addSetting: ' + setting.name);
    // Get the contents of the template
    const template = document.getElementById('template-setting');
    if (!template) {
        console.error('addSetting: template missing');
        return;
    }
    const templateHtml = template.innerHTML;
    // replace placeholder tags
    // with actual data, and generate final HTML
    const html = templateHtml.replace(/{{name}}/g, setting.name)
        .replace(/{{label}}/g, setting.label)
        .replace(/{{text}}/g, setting.text)
        .replace(/{{value}}/g, setting.value.toString());
    const article = document.createElement('article');
    article.innerHTML = html;
    section.appendChild(article);
    const editBtn = document.getElementById(setting.name + 'edit');
    const saveBtn = document.getElementById(setting.name + 'save');
    if (setting.readonly) {
        editBtn.style.display = 'none';
        saveBtn.style.display = 'none';
    }
    else {
        on('click', editBtn, () => {
            clickedEdit(setting.name);
        });
        on('click', saveBtn, () => {
            clickedSaved(setting.name);
        });
    }
    const settingDOM = HTMLSetting.create(setting);
}
function updateSetting(setting) {
    console.log('updateSetting: ' + setting.name);
    const input = document.getElementById(setting.name + 'value');
    const readonly = input.readOnly;
    input.readOnly = false;
    input.value = setting.value.toString();
    input.readOnly = readonly;
}
function editSetting(name) {
    const input = document.getElementById(name + 'value');
    const editBtn = document.getElementById(name + 'edit');
    const SaveBtn = document.getElementById(name + 'save');
    input.readOnly = false;
    input.classList.remove('settingReadonly');
    input.classList.add('settingEdit');
    editBtn.innerHTML = 'Cancel';
    SaveBtn.setAttribute('style', 'display:block');
}
function clickedEdit(name) {
    const setting = HTMLSetting.find(name);
    const input = document.getElementById(name + 'value');
    if (input.readOnly) {
        console.log('edit:', name);
        editSetting(name);
    }
    else {
        console.log('cancel:', name);
        readonlySetting(name);
    }
}
function clickedSaved(name) {
    console.log('clickedSaved:');
    const input = document.getElementById(name + 'value');
    const SaveBtn = document.getElementById(name + 'save');
    const setting = HTMLSetting.find(name);
    if (!input || !setting || !SaveBtn) {
        console.error('clickedSaved: could not find all HTML element');
        return;
    }
    setting.backstore = input.value;
    setting.value = input.value;
    SaveBtn.setAttribute('style', 'display:none');
    readonlySetting(name);
    socket.send(JSON.stringify({ command: 'saveSetting', data: setting }));
}
function readonlySetting(name) {
    const input = document.getElementById(name + 'value');
    const editBtn = document.getElementById(name + 'edit');
    const SaveBtn = document.getElementById(name + 'save');
    const setting = HTMLSetting.find(name);
    input.classList.remove('settingEdit');
    input.classList.add('settingReadonly');
    editBtn.innerHTML = 'Edit';
    editBtn.blur();
    input.value = setting.backstore;
    input.readOnly = true;
    SaveBtn.setAttribute('style', 'display:none');
}
function receiveSettings(allSettings) {
    const section = document.getElementById('settingsSection');
    for (const setting of allSettings) {
        if (HTMLSetting.has(setting.name)) {
            updateSetting(setting);
        }
        else {
            addSetting(setting, section);
        }
    }
}
function setConnectionStatus(connected) {
    const status = document.getElementById('connection');
    isMonitoring = connected && isMonitoring;
    setMonitoringButton();
    if (status && connected && isMonitoring) {
        status.innerHTML = ' (live)';
    }
    else if (status && connected) {
        status.innerHTML = ' (Connected)';
    }
    else if (status) {
        status.innerHTML = ' (Disconnected)';
    }
}
function monitor() {
    if (isMonitoring) {
        stopMonitor(sensors);
    }
    else {
        startMonitor(sensors);
    }
}
function clearSensorValue() {
    for (const sensor of sensors) {
        const sampleDate = sensor.samples[0].date;
        if (Date.now() - sampleDate > 60000) {
            const sensorValue = document.getElementById(sensorId(sensor.desc));
            if (sensorValue) {
                sensorValue.innerHTML = 'No sensor data received last 60 seconds';
            }
        }
    }
    setConnectionStatus(socket.readyState === socket.OPEN);
    if (socket.readyState === socket.CLOSED) {
        socket = new WebSocket(url);
    }
}
function round(value, precision) {
    //    precision || (precision = 1);
    const inverse = 1.0 / precision;
    return Math.round(value * inverse) / inverse;
}
},{}]},{},[1])
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJzcmMvYnJvd3Nlci9jbGllbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUNFQSxJQUFJLEVBQUUsQ0FBQztBQUVQO0lBQ0ksUUFBUSxFQUFFLENBQUM7SUFDWCxXQUFXLENBQUMsZUFBZSxDQUFDLENBQUM7SUFDN0IsTUFBTSxVQUFVLEdBQUcsUUFBUSxDQUFDLGNBQWMsQ0FBQyxTQUFTLENBQUMsQ0FBQztJQUN0RCxFQUFFLENBQUMsT0FBTyxFQUFFLFVBQVUsRUFBRyxHQUFFLEVBQUUsR0FBRyxPQUFPLEVBQUUsQ0FBQyxDQUFBLENBQUMsQ0FBQyxDQUFDO0FBQ2pELENBQUM7QUFFRDtJQUNJLE1BQU0sSUFBSSxHQUFHLFFBQVEsQ0FBQyxjQUFjLENBQUMsTUFBTSxDQUFDLENBQUM7SUFDN0MsT0FBTyxDQUFDLEdBQUcsQ0FBQyxZQUFZLENBQUMsQ0FBQztJQUMxQixJQUFJLENBQUMsV0FBVyxDQUFDLFFBQVEsQ0FBQyxTQUFTLEVBQUMsZUFBZSxDQUFDLENBQUMsQ0FBQztJQUN0RCxJQUFJLENBQUMsV0FBVyxDQUFDLFFBQVEsQ0FBQyxVQUFVLEVBQUMsaUJBQWlCLENBQUMsQ0FBQyxDQUFDO0FBQzdELENBQUM7QUFFRCxrQkFBa0IsSUFBWSxFQUFFLFNBQWlCO0lBQzdDLE9BQU8sQ0FBQyxHQUFHLENBQUMsaUNBQWlDLEVBQUUsSUFBSSxFQUFFLFNBQVMsQ0FBQyxDQUFDO0lBQ2hFLE1BQU0sRUFBRSxHQUFHLFFBQVEsQ0FBQyxhQUFhLENBQUMsSUFBSSxDQUFDLENBQUM7SUFDeEMsTUFBTSxDQUFDLEdBQUcsUUFBUSxDQUFDLGFBQWEsQ0FBQyxHQUFHLENBQUMsQ0FBQztJQUN0QyxDQUFDLENBQUMsU0FBUyxHQUFHLElBQUksQ0FBQztJQUNuQixFQUFFLENBQUMsT0FBTyxFQUFFLENBQUMsRUFBRSxHQUFFLEVBQUUsR0FBRyxXQUFXLENBQUMsU0FBUyxDQUFD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IiIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbigpe2Z1bmN0aW9uIHIoZSxuLHQpe2Z1bmN0aW9uIG8oaSxmKXtpZighbltpXSl7aWYoIWVbaV0pe3ZhciBjPVwiZnVuY3Rpb25cIj09dHlwZW9mIHJlcXVpcmUmJnJlcXVpcmU7aWYoIWYmJmMpcmV0dXJuIGMoaSwhMCk7aWYodSlyZXR1cm4gdShpLCEwKTt2YXIgYT1uZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiK2krXCInXCIpO3Rocm93IGEuY29kZT1cIk1PRFVMRV9OT1RfRk9VTkRcIixhfXZhciBwPW5baV09e2V4cG9ydHM6e319O2VbaV1bMF0uY2FsbChwLmV4cG9ydHMsZnVuY3Rpb24ocil7dmFyIG49ZVtpXVsxXVtyXTtyZXR1cm4gbyhufHxyKX0scCxwLmV4cG9ydHMscixlLG4sdCl9cmV0dXJuIG5baV0uZXhwb3J0c31mb3IodmFyIHU9XCJmdW5jdGlvblwiPT10eXBlb2YgcmVxdWlyZSYmcmVxdWlyZSxpPTA7aTx0Lmxlbmd0aDtpKyspbyh0W2ldKTtyZXR1cm4gb31yZXR1cm4gcn0pKCkiLCJpbXBvcnQgeyBzZXR0aW5ncyB9IGZyb20gJ2NsdXN0ZXInO1xyXG5cclxuaW5pdCgpO1xyXG5cclxuZnVuY3Rpb24gaW5pdCgpIHtcclxuICAgIGluaXRNZW51KCk7XHJcbiAgICBvcGVuU2VjdGlvbignc2Vuc29yU2VjdGlvbicpO1xyXG4gICAgY29uc3QgbW9uaXRvckJ0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtb25pdG9yJyk7XHJcbiAgICBvbignY2xpY2snLCBtb25pdG9yQnRuLCAgKCk9PiB7IG1vbml0b3IoKTt9KTtcclxufVxyXG5cclxuZnVuY3Rpb24gaW5pdE1lbnUoKSB7XHJcbiAgICBjb25zdCBtZW51ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21lbnUnKTtcclxuICAgIGNvbnNvbGUubG9nKCdpbml0TWVudSgpJyk7XHJcbiAgICBtZW51LmFwcGVuZENoaWxkKG1lbnVJdGVtKCdTZW5zb3JzJywnc2Vuc29yU2VjdGlvbicpKTtcclxuICAgIG1lbnUuYXBwZW5kQ2hpbGQobWVudUl0ZW0oJ1NldHRpbmdzJywnc2V0dGluZ3NTZWN0aW9uJykpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBtZW51SXRlbShuYW1lOiBzdHJpbmcsIHNlY3Rpb25JZDogc3RyaW5nKTogSFRNTEVsZW1lbnQge1xyXG4gICAgY29uc29sZS5sb2coJ21lbnVJdGVtOiBuYW1lPSVzLCBzZWN0aW9uSWQ9JXMnLCBuYW1lLCBzZWN0aW9uSWQpO1xyXG4gICAgY29uc3QgbGkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdsaScpO1xyXG4gICAgY29uc3QgYSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EnKTtcclxuICAgIGEuaW5uZXJIVE1MID0gbmFtZTtcclxuICAgIG9uKCdjbGljaycsIGEsICgpPT4geyBvcGVuU2VjdGlvbihzZWN0aW9uSWQpO30pO1xyXG5cclxuICAgIGxpLmFwcGVuZENoaWxkKGEpO1xyXG4gICAgcmV0dXJuIGxpO1xyXG59XHJcblxyXG5cclxuZnVuY3Rpb24gb24oZXZlbnQ6IHN0cmluZywgZWxlbWVudDogSFRNTEVsZW1lbnQgfCBudWxsLCBmbjogKCkgPT4gdm9pZCkge1xyXG4gICAgaWYgKGVsZW1lbnQpIHtcclxuICAgICAgICBjb25zb2xlLmxvZygnb24gJXM6IGFkZCBldmVudCBsaXN0ZW5lcicsIGV2ZW50KTtcclxuICAgICAgICBlbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoZXZlbnQsIGZuKTtcclxuICAgIH1cclxufVxyXG5cclxuZnVuY3Rpb24gb3BlblNlY3Rpb24oaWQ6IHN0cmluZykge1xyXG4gICAgY29uc29sZS5sb2coJ29wZW5TZWN0aW9uOiAnLCBpZCk7XHJcbiAgICBjbG9zZUFjdGl2ZVNlY3Rpb25zKCk7XHJcbiAgICBjb25zdCBzZWN0aW9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoaWQpO1xyXG4gICAgaWYgKHNlY3Rpb24pIHtcclxuICAgICAgICBjb25zb2xlLmxvZygnb3BlblNlY3Rpb246ICVzJywgaWQpO1xyXG4gICAgICAgIHNlY3Rpb24uc3R5bGUuZGlzcGxheSA9ICdibG9jayc7XHJcbiAgICAgICAgc2VjdGlvbi5jbGFzc0xpc3QuYWRkKCdhY3RpdmUnKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgY29uc29sZS5sb2coJ29wZW5TZWN0aW9uOiBzZWN0aW9uICVzIG5vdCBmb3VuZCcsIGlkKTtcclxuICAgIH1cclxuXHJcbn1cclxuXHJcbmZ1bmN0aW9uIGNsb3NlQWN0aXZlU2VjdGlvbnMoKSB7XHJcbiAgICBjb25zdCBhY3RpdmVJdGVtcyA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ2FjdGl2ZScpO1xyXG5cclxuICAgIGZvciAobGV0IGluZGV4ID0gMDsgaW5kZXggPCBhY3RpdmVJdGVtcy5sZW5ndGg7IGluZGV4KyspIHtcclxuICAgICAgICBjb25zdCBzZWN0aW9uID0gYWN0aXZlSXRlbXNbaW5kZXhdO1xyXG4gICAgICAgIHNlY3Rpb24uY2xhc3NMaXN0LnJlbW92ZSgnYWN0aXZlJyk7XHJcbiAgICAgICAgc2VjdGlvbi5zZXRBdHRyaWJ1dGUoJ3N0eWxlJywgJ2Rpc3BsYXk6bm9uZScpO1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIFNlbnNvckRlc2NyaXB0aW9uIHtcclxuICAgIFNOOiBzdHJpbmc7XHJcbiAgICBwb3J0OiBudW1iZXI7XHJcbn1cclxuZXhwb3J0IGludGVyZmFjZSBTZW5zb3JTYW1wbGUge1xyXG4gICAgdmFsdWU6IG51bWJlcjtcclxuICAgIGRhdGU6IG51bWJlcjtcclxufVxyXG5leHBvcnQgaW50ZXJmYWNlIFNlbnNvckxvZyB7XHJcbiAgICBkZXNjOiBTZW5zb3JEZXNjcmlwdGlvbjtcclxuICAgIHNhbXBsZXM6IFNlbnNvclNhbXBsZVtdO1xyXG59XHJcbmV4cG9ydCB0eXBlIFNldHRpbmdWYWx1ZSA9IHN0cmluZyB8IG51bWJlcjtcclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgU2V0dGluZyB7XHJcbiAgICBuYW1lOiBzdHJpbmc7XHJcbiAgICBsYWJlbDogc3RyaW5nO1xyXG4gICAgdmFsdWU6IFNldHRpbmdWYWx1ZTtcclxuICAgIGRlZmF1bHRWYWx1ZTogU2V0dGluZ1ZhbHVlO1xyXG4gICAgdGV4dDogc3RyaW5nO1xyXG4gICAgcmVhZG9ubHk6IGJvb2xlYW47XHJcbn1cclxuXHJcbmNvbnN0IHNlbnNvcnM6IFNlbnNvckxvZ1tdID0gW107XHJcbi8vIGxldCBzZXR0aW5ncyA9IFtdO1xyXG5cclxuY29uc3QgdXJsID0gJ3dzOi8vJyArIGRvY3VtZW50LmRvbWFpbjtcclxubGV0IHNvY2tldCA9IG5ldyBXZWJTb2NrZXQodXJsKTtcclxuc29ja2V0Lm9ub3BlbiA9IGZ1bmN0aW9uKCkge1xyXG4gICAgc2V0Q29ubmVjdGlvblN0YXR1cyh0cnVlKTtcclxuICAgIHNvY2tldC5zZW5kKEpTT04uc3RyaW5naWZ5KHtjb21tYW5kOiAnZ2V0U2Vuc29ycyd9KSk7XHJcbiAgICBzb2NrZXQuc2VuZChKU09OLnN0cmluZ2lmeSh7Y29tbWFuZDogJ2dldFNldHRpbmdzJ30pKTtcclxufTtcclxuXHJcbnNvY2tldC5vbm1lc3NhZ2UgPSBmdW5jdGlvbihldmVudCkge1xyXG4gICAgc2V0Q29ubmVjdGlvblN0YXR1cyh0cnVlKTtcclxuICAgIGNvbnN0IG1zZyA9IEpTT04ucGFyc2UoZXZlbnQuZGF0YSk7XHJcbiAgICBzd2l0Y2gobXNnLmNvbW1hbmQpIHtcclxuICAgICAgICBjYXNlICdzZW5zb3JzJzpcclxuICAgICAgICAgICAgcmVjZWl2ZVNlbnNvcnMobXNnLmRhdGEpO1xyXG4gICAgICAgICAgICBpZiAoIWlzTW9uaXRvcmluZykge1xyXG4gICAgICAgICAgICAgICAgc3RhcnRNb25pdG9yKHNlbnNvcnMpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIGNhc2UgJ3NldHRpbmdzJzpcclxuICAgICAgICAgICAgcmVjZWl2ZVNldHRpbmdzKG1zZy5kYXRhKTtcclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgY2FzZSAnbG9nJzpcclxuICAgICAgICAgICAgbG9nKG1zZy5kYXRhKTtcclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgIH1cclxufTtcclxuXHJcbnNvY2tldC5vbmNsb3NlID0gZnVuY3Rpb24oKSB7XHJcbiAgICBzZXRDb25uZWN0aW9uU3RhdHVzKGZhbHNlKTtcclxuICAgIGNsZWFyVGltZW91dChsb2dUaW1lcik7XHJcbiAgICBsb2dUaW1lciA9IHNldEludGVydmFsKGNsZWFyU2Vuc29yVmFsdWUsIDUwMDApO1xyXG59O1xyXG5cclxuc29ja2V0Lm9uZXJyb3IgPSBmdW5jdGlvbigpIHtcclxuICAgIHNldENvbm5lY3Rpb25TdGF0dXMoZmFsc2UpO1xyXG4gICAgY2xlYXJUaW1lb3V0KGxvZ1RpbWVyKTtcclxuICAgIGxvZ1RpbWVyID0gc2V0SW50ZXJ2YWwoY2xlYXJTZW5zb3JWYWx1ZSwgNTAwMCk7XHJcbn07XHJcblxyXG5cclxuXHJcbmZ1bmN0aW9uIHNlbnNvck5hbWUoZGVzYzogU2Vuc29yRGVzY3JpcHRpb24pOiBzdHJpbmcge1xyXG4gICAgcmV0dXJuIGRlc2MuU04gKyAnLCBwb3J0ICcgKyBkZXNjLnBvcnQ7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHNlbnNvcklkKGRlc2M6IFNlbnNvckRlc2NyaXB0aW9uKTogc3RyaW5nIHtcclxuICAgIGNvbnN0IHNuID0gZGVzYy5TTi5yZXBsYWNlKCcgJywgZGVzYy5TTik7XHJcbiAgICBjb25zdCBpZCA9IGRlc2MuU04ucmVwbGFjZSgnICcsIGRlc2MuU04pICsgJy0nICsgZGVzYy5wb3J0O1xyXG4gICAgcmV0dXJuIGlkO1xyXG59XHJcblxyXG5mdW5jdGlvbiByZWNlaXZlU2Vuc29ycyhzZW5zb3JzOiBTZW5zb3JMb2dbXSkge1xyXG4gICAgY29uc3Qgc2VjdGlvbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzZW5zb3JTZWN0aW9uJyk7XHJcbiAgICBmb3IgKGNvbnN0IHNlbnNvciBvZiBzZW5zb3JzKSB7XHJcbiAgICAgICAgY29uc3QgYXJ0aWNsZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2FydGljbGUnKTtcclxuICAgICAgICBjb25zdCBoZWFkaW5nID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaDMnKTtcclxuXHJcbiAgICAgICAgaGVhZGluZy5pZCA9IHNlbnNvcklkKHNlbnNvci5kZXNjKSArICctdmFsdWUnO1xyXG4gICAgICAgIGFydGljbGUuYXBwZW5kQ2hpbGQoaGVhZGluZyk7XHJcblxyXG4gICAgICAgIGNvbnN0IGRlc2MgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdwJyk7XHJcbiAgICAgICAgZGVzYy5pZCA9IHNlbnNvcklkKHNlbnNvci5kZXNjKTtcclxuICAgICAgICBhcnRpY2xlLmFwcGVuZENoaWxkKGRlc2MpO1xyXG4gICAgICAgIGlmIChzZWN0aW9uKSB7XHJcbiAgICAgICAgICAgIHNlY3Rpb24uYXBwZW5kQ2hpbGQoYXJ0aWNsZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgbG9nKHNlbnNvcnMpO1xyXG59XHJcbmxldCBpc01vbml0b3JpbmcgPSBmYWxzZTtcclxuZnVuY3Rpb24gc2V0TW9uaXRvcmluZ0J1dHRvbigpIHtcclxuICAgIGNvbnN0IGJ1dHRvbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtb25pdG9yJyk7XHJcbiAgICBpZiAoIWJ1dHRvbikgeyByZXR1cm47IH1cclxuICAgIGlmIChpc01vbml0b3JpbmcpIHtcclxuICAgICAgICBidXR0b24uaW5uZXJIVE1MID0gJ1N0b3AgbW9uaXRvcic7XHJcbiAgICAgICAgYnV0dG9uLmNsYXNzTGlzdC5hZGQoJ2lzTW9uaXRvcmluZycpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICBidXR0b24uaW5uZXJIVE1MID0gJ1N0YXJ0IE1vbml0b3InO1xyXG4gICAgICAgIGJ1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKCdpc01vbml0b3JpbmcnKTtcclxuICAgIH1cclxufVxyXG5cclxuZnVuY3Rpb24gc3RhcnRNb25pdG9yKHNlbnNvcnM6IFNlbnNvckxvZ1tdKSB7XHJcbiAgICBpc01vbml0b3JpbmcgPSB0cnVlO1xyXG4gICAgc2V0TW9uaXRvcmluZ0J1dHRvbigpO1xyXG4gICAgY29uc3QgY29tbWFuZCA9ICdzdGFydE1vbml0b3InO1xyXG4gICAgY29uc3QgZGF0YTogYW55ID0gW107XHJcbiAgICBmb3IgKGNvbnN0IHNlbnNvciBvZiBzZW5zb3JzKSB7XHJcbiAgICAgICAgZGF0YS5wdXNoKHNlbnNvci5kZXNjKTtcclxuICAgIH1cclxuICAgIHNvY2tldC5zZW5kKEpTT04uc3RyaW5naWZ5KHtjb21tYW5kLCBkYXRhfSkpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBzdG9wTW9uaXRvcihzZW5zb3JzOiBTZW5zb3JMb2dbXSkge1xyXG4gICAgaXNNb25pdG9yaW5nID0gZmFsc2U7XHJcbiAgICBzZXRNb25pdG9yaW5nQnV0dG9uKCk7XHJcbiAgICBjb25zdCBjb21tYW5kID0gJ3N0b3BNb25pdG9yJztcclxuICAgIGNvbnN0IGRhdGE6IGFueSA9IFtdO1xyXG4gICAgZm9yIChjb25zdCBzZW5zb3Igb2Ygc2Vuc29ycykge1xyXG4gICAgICAgIGRhdGEucHVzaChzZW5zb3IuZGVzYyk7XHJcbiAgICB9XHJcbiAgICBzb2NrZXQuc2VuZChKU09OLnN0cmluZ2lmeSh7Y29tbWFuZCwgZGF0YX0pKTtcclxufVxyXG5sZXQgbG9nVGltZXI6IGFueTtcclxuZnVuY3Rpb24gbG9nKHNlbnNvckRhdGE6IFNlbnNvckxvZ1tdKSB7XHJcbiAgICBmb3IgKGNvbnN0IHNlbnNvciBvZiBzZW5zb3JEYXRhKSB7XHJcbiAgICAgICAgY29uc3QgbG9nID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoc2Vuc29ySWQoc2Vuc29yLmRlc2MpICsgJy12YWx1ZScpO1xyXG4gICAgICAgIGlmIChsb2cpIHtcclxuICAgICAgICAgICAgY29uc3QgZGF0ZSA9IG5ldyBEYXRlKHNlbnNvci5zYW1wbGVzWzBdLmRhdGUpO1xyXG4gICAgICAgICAgICBjb25zdCB2YWx1ZSA9IHNlbnNvci5zYW1wbGVzWzBdLnZhbHVlO1xyXG4gICAgICAgICAgICBsb2cuaW5uZXJIVE1MID0gdmFsdWUgKyAnIMKwQyc7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnN0IGRlc2MgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChzZW5zb3JJZChzZW5zb3IuZGVzYykpO1xyXG4gICAgICAgIGlmIChkZXNjKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGRhdGUgPSBuZXcgRGF0ZShzZW5zb3Iuc2FtcGxlc1swXS5kYXRlKTtcclxuICAgICAgICAgICAgY29uc3QgdmFsdWUgPSBzZW5zb3Iuc2FtcGxlc1swXS52YWx1ZTtcclxuICAgICAgICAgICAgZGVzYy5pbm5lckhUTUwgPSAnYnkgJyArIHNlbnNvck5hbWUoc2Vuc29yLmRlc2MpICArICc6ICcgK1xyXG4gICAgICAgICAgICAgICAgZGF0ZS50b0xvY2FsZURhdGVTdHJpbmcoKSArICcsICcgKyBkYXRlLnRvTG9jYWxlVGltZVN0cmluZygpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjbGVhclRpbWVvdXQobG9nVGltZXIpO1xyXG4gICAgICAgIGxvZ1RpbWVyID0gc2V0SW50ZXJ2YWwoY2xlYXJTZW5zb3JWYWx1ZSwgMzAwMCk7XHJcbiAgICB9XHJcbn1cclxuY2xhc3MgSFRNTFNldHRpbmcgaW1wbGVtZW50cyBTZXR0aW5nIHtcclxuICAgIHByaXZhdGUgc3RhdGljIHNldHRpbmdzOiBIVE1MU2V0dGluZ1tdID0gW107XHJcbiAgICBwdWJsaWMgdmFsdWU6IFNldHRpbmdWYWx1ZTtcclxuICAgIHB1YmxpYyBsYWJlbDogc3RyaW5nO1xyXG4gICAgcHVibGljIGRlZmF1bHRWYWx1ZTogU2V0dGluZ1ZhbHVlO1xyXG4gICAgcHVibGljIHRleHQ6IHN0cmluZztcclxuICAgIHB1YmxpYyByZWFkb25seTogYm9vbGVhbjtcclxuICAgIHB1YmxpYyBuYW1lOiBzdHJpbmc7XHJcbiAgICBwdWJsaWMgYmFja3N0b3JlOiBzdHJpbmc7XHJcbiAgICBwdWJsaWMgaW5wdXQ6IEhUTUxJbnB1dEVsZW1lbnQ7XHJcbiAgICBwdWJsaWMgZWRpdEJ0bjogSFRNTEJ1dHRvbkVsZW1lbnQ7XHJcbiAgICBwdWJsaWMgU2F2ZUJ0bjogSFRNTEJ1dHRvbkVsZW1lbnQ7XHJcbiAgICBjb25zdHJ1Y3RvcihzZXR0aW5nOiBTZXR0aW5nKSB7XHJcbiAgICAgICAgdGhpcy5uYW1lID0gc2V0dGluZy5uYW1lO1xyXG4gICAgICAgIHRoaXMubGFiZWwgPSBzZXR0aW5nLmxhYmVsO1xyXG4gICAgICAgIHRoaXMudmFsdWUgPSBzZXR0aW5nLnZhbHVlO1xyXG4gICAgICAgIHRoaXMuZGVmYXVsdFZhbHVlID0gc2V0dGluZy5kZWZhdWx0VmFsdWU7XHJcbiAgICAgICAgdGhpcy50ZXh0ID0gc2V0dGluZy50ZXh0O1xyXG4gICAgICAgIHRoaXMucmVhZG9ubHkgPSBzZXR0aW5nLnJlYWRvbmx5O1xyXG4gICAgICAgIHRoaXMuaW5wdXQgPSA8SFRNTElucHV0RWxlbWVudD5kb2N1bWVudC5nZXRFbGVtZW50QnlJZChuYW1lICsndmFsdWUnKTtcclxuICAgICAgICB0aGlzLmJhY2tzdG9yZSA9IHRoaXMudmFsdWUudG9TdHJpbmcoKTtcclxuICAgICAgICB0aGlzLmVkaXRCdG4gPSA8SFRNTEJ1dHRvbkVsZW1lbnQ+ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQobmFtZSArJ2VkaXQnKTtcclxuICAgICAgICB0aGlzLlNhdmVCdG4gPSA8SFRNTEJ1dHRvbkVsZW1lbnQ+ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQobmFtZSArJ3NhdmUnKTtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgc3RhdGljIGNyZWF0ZShzZXR0aW5nOiBTZXR0aW5nKTogSFRNTFNldHRpbmcge1xyXG4gICAgICAgIGlmICghSFRNTFNldHRpbmcuaGFzIChzZXR0aW5nLm5hbWUpKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IG5ld1NldHRpbmcgPSBuZXcgSFRNTFNldHRpbmcoc2V0dGluZyk7XHJcbiAgICAgICAgICAgIEhUTUxTZXR0aW5nLnNldHRpbmdzLnB1c2gobmV3U2V0dGluZyk7XHJcbiAgICAgICAgICAgIHJldHVybiBuZXdTZXR0aW5nO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0hUTUxTZXR0aW5nLmNyZWF0ZTogc2V0dGluZyBleGlzdHMgJywgc2V0dGluZy5uYW1lKTtcclxuICAgICAgICAgICAgdGhyb3cgRXJyb3IoKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBwdWJsaWMgc3RhdGljIGZpbmQobmFtZTogc3RyaW5nKTogSFRNTFNldHRpbmcge1xyXG4gICAgICAgIGZvciAoY29uc3Qgc2V0dGluZyBvZiBIVE1MU2V0dGluZy5zZXR0aW5ncykge1xyXG4gICAgICAgICAgICBpZiAoc2V0dGluZy5uYW1lID09PSBuYW1lKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gc2V0dGluZztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBjb25zb2xlLmVycm9yKCdTZXR0aW5nLmZpbmQ6IHNldHRpbmcgXCIlc1wiIG5vdCBmb3VuZCcsIG5hbWUpO1xyXG4gICAgICAgIGNvbnNvbGUubG9nKCdIVE1MU2V0dGluZy5nZXQ6IGxlbmd0aD0nLCBIVE1MU2V0dGluZy5zZXR0aW5ncy5sZW5ndGgpO1xyXG4gICAgICAgIHRocm93IEVycm9yKCk7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIHN0YXRpYyBoYXMobmFtZTogc3RyaW5nICk6IGJvb2xlYW4ge1xyXG4gICAgICAgIGZvciAoY29uc3Qgc2V0dGluZyBvZiBIVE1MU2V0dGluZy5zZXR0aW5ncykge1xyXG4gICAgICAgICAgICBpZiAoc2V0dGluZy5uYW1lID09PSBuYW1lKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcbiAgICBwdWJsaWMgZWRpdFNldHRpbmcoKSB7XHJcbiAgICAgICAgdGhpcy5iYWNrc3RvcmUgPSAgdGhpcy5pbnB1dC52YWx1ZTtcclxuICAgICAgICB0aGlzLmlucHV0LnJlYWRPbmx5PXRydWU7XHJcbiAgICAgICAgdGhpcy5pbnB1dC5jbGFzc0xpc3QucmVtb3ZlKCdzZXR0aW5nUmVhZG9ubHknKTtcclxuICAgICAgICB0aGlzLmlucHV0LmNsYXNzTGlzdC5hZGQoJ3NldHRpbmdFZGl0Jyk7XHJcblxyXG4gICAgICAgIHRoaXMuZWRpdEJ0bi5pbm5lckhUTUw9J0F2YnJ5dCc7XHJcbiAgICAgICAgdGhpcy5lZGl0QnRuLmNsYXNzTGlzdC5yZW1vdmUoJ3NldHRpbmdSZWFkb25seScpO1xyXG4gICAgICAgIHRoaXMuZWRpdEJ0bi5jbGFzc0xpc3QuYWRkKCdzZXR0aW5nRWRpdCcpO1xyXG5cclxuICAgICAgICB0aGlzLlNhdmVCdG4uc2V0QXR0cmlidXRlKCdzdHlsZScsICdkaXNwbGF5OmJsb2NrJyk7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIHJlYWRvbmx5U2V0dGluZygpIHtcclxuICAgICAgICB0aGlzLmlucHV0LnZhbHVlPXRoaXMuYmFja3N0b3JlO1xyXG4gICAgICAgIHRoaXMuaW5wdXQucmVhZE9ubHk9ZmFsc2U7XHJcbiAgICAgICAgdGhpcy5pbnB1dC5jbGFzc0xpc3QucmVtb3ZlKCdzZXR0aW5nRWRpdCcpO1xyXG4gICAgICAgIHRoaXMuaW5wdXQuY2xhc3NMaXN0LmFkZCgnc2V0dGluZ1JlYWRvbmx5Jyk7XHJcblxyXG4gICAgICAgIHRoaXMuZWRpdEJ0bi5pbm5lckhUTUw9J8OEbmRyYSc7XHJcbiAgICAgICAgdGhpcy5lZGl0QnRuLmNsYXNzTGlzdC5yZW1vdmUoJ3NldHRpbmdFZGl0Jyk7XHJcbiAgICAgICAgdGhpcy5lZGl0QnRuLmNsYXNzTGlzdC5hZGQoJ3NldHRpbmdSZWFkb25seScpO1xyXG5cclxuICAgICAgICB0aGlzLlNhdmVCdG4uc2V0QXR0cmlidXRlKCdzdHlsZScsICdkaXNwbGF5Om5vbmUnKTtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgc2F2ZVNldHRpbmcoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuYmFja3N0b3JlICE9PSB0aGlzLmlucHV0LnZhbHVlKSB7XHJcbiAgICAgICAgICAgIHRoaXMuYmFja3N0b3JlPXRoaXMuaW5wdXQudmFsdWU7XHJcbiAgICAgICAgIH1cclxuICAgICAgICB0aGlzLnJlYWRvbmx5U2V0dGluZygpO1xyXG4gICAgfVxyXG59XHJcblxyXG5cclxuZnVuY3Rpb24gYWRkU2V0dGluZyhzZXR0aW5nOiBTZXR0aW5nLCBzZWN0aW9uOiBIVE1MRWxlbWVudCkge1xyXG4gICAgY29uc29sZS5sb2coJ2FkZFNldHRpbmc6ICcgKyBzZXR0aW5nLm5hbWUpO1xyXG4gICAgLy8gR2V0IHRoZSBjb250ZW50cyBvZiB0aGUgdGVtcGxhdGVcclxuICAgIGNvbnN0IHRlbXBsYXRlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3RlbXBsYXRlLXNldHRpbmcnKTtcclxuICAgIGlmICghdGVtcGxhdGUpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdhZGRTZXR0aW5nOiB0ZW1wbGF0ZSBtaXNzaW5nJyk7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgY29uc3QgdGVtcGxhdGVIdG1sID0gdGVtcGxhdGUuaW5uZXJIVE1MO1xyXG5cclxuICAgIC8vIHJlcGxhY2UgcGxhY2Vob2xkZXIgdGFnc1xyXG4gICAgLy8gd2l0aCBhY3R1YWwgZGF0YSwgYW5kIGdlbmVyYXRlIGZpbmFsIEhUTUxcclxuXHJcbiAgICBjb25zdCBodG1sID0gdGVtcGxhdGVIdG1sLnJlcGxhY2UoL3t7bmFtZX19L2csIHNldHRpbmcubmFtZSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5yZXBsYWNlKC97e2xhYmVsfX0vZywgc2V0dGluZy5sYWJlbClcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5yZXBsYWNlKC97e3RleHR9fS9nLCBzZXR0aW5nLnRleHQpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAucmVwbGFjZSgve3t2YWx1ZX19L2csIHNldHRpbmcudmFsdWUudG9TdHJpbmcoKSk7XHJcblxyXG4gICAgY29uc3QgYXJ0aWNsZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2FydGljbGUnKTtcclxuICAgIGFydGljbGUuaW5uZXJIVE1MID0gaHRtbDtcclxuICAgIHNlY3Rpb24uYXBwZW5kQ2hpbGQoYXJ0aWNsZSk7XHJcbiAgICBjb25zdCBlZGl0QnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoc2V0dGluZy5uYW1lICsgJ2VkaXQnKTtcclxuICAgIGNvbnN0IHNhdmVCdG4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChzZXR0aW5nLm5hbWUgKyAnc2F2ZScpO1xyXG4gICAgaWYgKHNldHRpbmcucmVhZG9ubHkpIHtcclxuICAgICAgICBlZGl0QnRuLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XHJcbiAgICAgICAgc2F2ZUJ0bi5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICBvbiAoJ2NsaWNrJywgZWRpdEJ0biwgKCk9PiB7XHJcbiAgICAgICAgICAgIGNsaWNrZWRFZGl0KHNldHRpbmcubmFtZSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgb24gKCdjbGljaycsIHNhdmVCdG4sICgpPT4ge1xyXG4gICAgICAgICAgICBjbGlja2VkU2F2ZWQoc2V0dGluZy5uYW1lKTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBzZXR0aW5nRE9NOiBIVE1MU2V0dGluZyA9ICBIVE1MU2V0dGluZy5jcmVhdGUoc2V0dGluZyk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHVwZGF0ZVNldHRpbmcoc2V0dGluZzogU2V0dGluZykge1xyXG4gICAgY29uc29sZS5sb2coJ3VwZGF0ZVNldHRpbmc6ICcgKyBzZXR0aW5nLm5hbWUpO1xyXG4gICAgY29uc3QgaW5wdXQgPSA8SFRNTElucHV0RWxlbWVudD5kb2N1bWVudC5nZXRFbGVtZW50QnlJZChzZXR0aW5nLm5hbWUgKyd2YWx1ZScpO1xyXG4gICAgY29uc3QgcmVhZG9ubHkgPSBpbnB1dC5yZWFkT25seTtcclxuICAgIGlucHV0LnJlYWRPbmx5PWZhbHNlO1xyXG4gICAgaW5wdXQudmFsdWUgPSBzZXR0aW5nLnZhbHVlLnRvU3RyaW5nKCk7XHJcbiAgICBpbnB1dC5yZWFkT25seSA9IHJlYWRvbmx5O1xyXG59XHJcblxyXG5mdW5jdGlvbiBlZGl0U2V0dGluZyhuYW1lOiBzdHJpbmcpIHtcclxuICAgIGNvbnN0IGlucHV0ID0gPEhUTUxJbnB1dEVsZW1lbnQ+ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQobmFtZSArJ3ZhbHVlJyk7XHJcbiAgICBjb25zdCBlZGl0QnRuID0gPEhUTUxCdXR0b25FbGVtZW50PmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKG5hbWUgKydlZGl0Jyk7XHJcbiAgICBjb25zdCBTYXZlQnRuID0gPEhUTUxCdXR0b25FbGVtZW50PmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKG5hbWUgKydzYXZlJyk7XHJcbiAgICBpbnB1dC5yZWFkT25seSA9IGZhbHNlO1xyXG4gICAgaW5wdXQuY2xhc3NMaXN0LnJlbW92ZSgnc2V0dGluZ1JlYWRvbmx5Jyk7XHJcbiAgICBpbnB1dC5jbGFzc0xpc3QuYWRkKCdzZXR0aW5nRWRpdCcpO1xyXG5cclxuICAgIGVkaXRCdG4uaW5uZXJIVE1MPSdDYW5jZWwnO1xyXG5cclxuICAgIFNhdmVCdG4uc2V0QXR0cmlidXRlKCdzdHlsZScsICdkaXNwbGF5OmJsb2NrJyk7XHJcbn1cclxuZnVuY3Rpb24gY2xpY2tlZEVkaXQobmFtZTogc3RyaW5nKSB7XHJcbiAgICBjb25zdCBzZXR0aW5nID0gSFRNTFNldHRpbmcuZmluZChuYW1lKTtcclxuICAgIGNvbnN0IGlucHV0PTxIVE1MSW5wdXRFbGVtZW50PmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKG5hbWUgKyd2YWx1ZScpO1xyXG4gICAgaWYgKGlucHV0LnJlYWRPbmx5KSB7XHJcbiAgICAgICAgY29uc29sZS5sb2coJ2VkaXQ6JywgbmFtZSk7XHJcbiAgICAgICAgZWRpdFNldHRpbmcobmFtZSk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKCdjYW5jZWw6JywgbmFtZSk7XHJcbiAgICAgICAgcmVhZG9ubHlTZXR0aW5nKG5hbWUpO1xyXG4gICAgfVxyXG59XHJcbmZ1bmN0aW9uIGNsaWNrZWRTYXZlZChuYW1lOiBzdHJpbmcpIHtcclxuICAgIGNvbnNvbGUubG9nKCdjbGlja2VkU2F2ZWQ6Jyk7XHJcbiAgICBjb25zdCBpbnB1dCA9IDxIVE1MSW5wdXRFbGVtZW50PmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKG5hbWUgKyd2YWx1ZScpO1xyXG4gICAgY29uc3QgU2F2ZUJ0biA9IDxIVE1MQnV0dG9uRWxlbWVudD5kb2N1bWVudC5nZXRFbGVtZW50QnlJZChuYW1lICsnc2F2ZScpO1xyXG4gICAgY29uc3Qgc2V0dGluZzogSFRNTFNldHRpbmcgPSBIVE1MU2V0dGluZy5maW5kKG5hbWUpO1xyXG4gICAgaWYgKCFpbnB1dCB8fCAhc2V0dGluZyB8fCAhU2F2ZUJ0bikge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ2NsaWNrZWRTYXZlZDogY291bGQgbm90IGZpbmQgYWxsIEhUTUwgZWxlbWVudCcpO1xyXG4gICAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIHNldHRpbmcuYmFja3N0b3JlID0gaW5wdXQudmFsdWU7XHJcbiAgICBzZXR0aW5nLnZhbHVlID0gaW5wdXQudmFsdWU7XHJcbiAgICBTYXZlQnRuLnNldEF0dHJpYnV0ZSgnc3R5bGUnLCAnZGlzcGxheTpub25lJyk7XHJcbiAgICByZWFkb25seVNldHRpbmcobmFtZSk7XHJcbiAgICBzb2NrZXQuc2VuZChKU09OLnN0cmluZ2lmeSh7Y29tbWFuZDogJ3NhdmVTZXR0aW5nJywgZGF0YTogPFNldHRpbmc+c2V0dGluZ30pKTtcclxufVxyXG5cclxuZnVuY3Rpb24gcmVhZG9ubHlTZXR0aW5nKG5hbWU6IHN0cmluZykge1xyXG4gICAgY29uc3QgaW5wdXQgPSA8SFRNTElucHV0RWxlbWVudD5kb2N1bWVudC5nZXRFbGVtZW50QnlJZChuYW1lICsndmFsdWUnKTtcclxuICAgIGNvbnN0IGVkaXRCdG4gPSA8SFRNTEJ1dHRvbkVsZW1lbnQ+ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQobmFtZSArJ2VkaXQnKTtcclxuICAgIGNvbnN0IFNhdmVCdG4gPSA8SFRNTEJ1dHRvbkVsZW1lbnQ+ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQobmFtZSArJ3NhdmUnKTtcclxuICAgIGNvbnN0IHNldHRpbmcgPSBIVE1MU2V0dGluZy5maW5kKG5hbWUpO1xyXG5cclxuICAgIGlucHV0LmNsYXNzTGlzdC5yZW1vdmUoJ3NldHRpbmdFZGl0Jyk7XHJcbiAgICBpbnB1dC5jbGFzc0xpc3QuYWRkKCdzZXR0aW5nUmVhZG9ubHknKTtcclxuXHJcbiAgICBlZGl0QnRuLmlubmVySFRNTD0nRWRpdCc7XHJcblxyXG4gICAgZWRpdEJ0bi5ibHVyKCk7XHJcblxyXG4gICAgaW5wdXQudmFsdWU9c2V0dGluZy5iYWNrc3RvcmU7XHJcbiAgICBpbnB1dC5yZWFkT25seT10cnVlO1xyXG5cclxuICAgIFNhdmVCdG4uc2V0QXR0cmlidXRlKCdzdHlsZScsICdkaXNwbGF5Om5vbmUnKTtcclxufVxyXG5cclxuXHJcbmZ1bmN0aW9uIHJlY2VpdmVTZXR0aW5ncyhhbGxTZXR0aW5nczogU2V0dGluZ1tdKSB7XHJcbiAgICBjb25zdCBzZWN0aW9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NldHRpbmdzU2VjdGlvbicpO1xyXG4gICAgZm9yIChjb25zdCBzZXR0aW5nIG9mIGFsbFNldHRpbmdzKSB7XHJcbiAgICAgICAgaWYgKEhUTUxTZXR0aW5nLmhhcyhzZXR0aW5nLm5hbWUpKSB7XHJcbiAgICAgICAgICAgIHVwZGF0ZVNldHRpbmcoc2V0dGluZyk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgYWRkU2V0dGluZyhzZXR0aW5nLCBzZWN0aW9uKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cclxuZnVuY3Rpb24gc2V0Q29ubmVjdGlvblN0YXR1cyhjb25uZWN0ZWQ6IGJvb2xlYW4pIHtcclxuICAgIGNvbnN0IHN0YXR1cyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjb25uZWN0aW9uJyk7XHJcbiAgICBpc01vbml0b3JpbmcgPSBjb25uZWN0ZWQgJiYgaXNNb25pdG9yaW5nO1xyXG4gICAgc2V0TW9uaXRvcmluZ0J1dHRvbigpO1xyXG4gICAgaWYgKHN0YXR1cyAmJiBjb25uZWN0ZWQgJiYgaXNNb25pdG9yaW5nKSB7XHJcbiAgICAgICAgc3RhdHVzLmlubmVySFRNTCA9ICcgKGxpdmUpJztcclxuICAgIH0gZWxzZSBpZiAoc3RhdHVzICYmIGNvbm5lY3RlZCkge1xyXG4gICAgICAgIHN0YXR1cy5pbm5lckhUTUwgPSAnIChDb25uZWN0ZWQpJztcclxuICAgIH0gZWxzZSBpZiAoc3RhdHVzKSB7XHJcbiAgICAgICAgc3RhdHVzLmlubmVySFRNTCA9ICcgKERpc2Nvbm5lY3RlZCknO1xyXG4gICAgfVxyXG59XHJcblxyXG5mdW5jdGlvbiBtb25pdG9yKCkge1xyXG4gICAgaWYgKGlzTW9uaXRvcmluZykge1xyXG4gICAgICAgIHN0b3BNb25pdG9yKHNlbnNvcnMpO1xyXG5cclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgc3RhcnRNb25pdG9yKHNlbnNvcnMpO1xyXG4gICAgfVxyXG59XHJcblxyXG5mdW5jdGlvbiBjbGVhclNlbnNvclZhbHVlKCkge1xyXG4gICAgZm9yIChjb25zdCBzZW5zb3Igb2Ygc2Vuc29ycykge1xyXG4gICAgICAgIGNvbnN0IHNhbXBsZURhdGUgPSBzZW5zb3Iuc2FtcGxlc1swXS5kYXRlO1xyXG4gICAgICAgIGlmIChEYXRlLm5vdygpIC0gc2FtcGxlRGF0ZSA+IDYwXzAwMCkge1xyXG4gICAgICAgICAgICBjb25zdCBzZW5zb3JWYWx1ZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHNlbnNvcklkKHNlbnNvci5kZXNjKSk7XHJcbiAgICAgICAgICAgIGlmIChzZW5zb3JWYWx1ZSkge1xyXG4gICAgICAgICAgICAgICAgc2Vuc29yVmFsdWUuaW5uZXJIVE1MID0gJ05vIHNlbnNvciBkYXRhIHJlY2VpdmVkIGxhc3QgNjAgc2Vjb25kcyc7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgc2V0Q29ubmVjdGlvblN0YXR1cyhzb2NrZXQucmVhZHlTdGF0ZSA9PT0gc29ja2V0Lk9QRU4pO1xyXG4gICAgaWYgKHNvY2tldC5yZWFkeVN0YXRlID09PSBzb2NrZXQuQ0xPU0VEKSB7XHJcbiAgICAgICAgc29ja2V0ID0gbmV3IFdlYlNvY2tldCh1cmwpO1xyXG4gICAgfVxyXG59XHJcblxyXG5mdW5jdGlvbiByb3VuZCh2YWx1ZTogbnVtYmVyLCBwcmVjaXNpb246IG51bWJlcikge1xyXG4gICAgLy8gICAgcHJlY2lzaW9uIHx8IChwcmVjaXNpb24gPSAxKTtcclxuICAgIGNvbnN0IGludmVyc2UgPSAxLjAgLyBwcmVjaXNpb247XHJcbiAgICByZXR1cm4gTWF0aC5yb3VuZCh2YWx1ZSAqIGludmVyc2UpIC8gaW52ZXJzZTtcclxufVxyXG4iXX0=
