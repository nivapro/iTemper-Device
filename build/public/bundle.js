(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){
init();
function init() {
    initMenu();
    openSection('sensorSection');
    const monitorBtn = document.getElementById('monitor');
    on('click', monitorBtn, () => { monitor(); });
}
function initMenu() {
    const menu = document.getElementById('menu');
    console.log('initMenu()');
    menu.appendChild(menuItem('Sensors', 'sensorSection'));
    menu.appendChild(menuItem('Settings', 'settingsSection'));
}
function menuItem(name, sectionId) {
    console.log('menuItem: name=%s, sectionId=%s', name, sectionId);
    const li = document.createElement('li');
    const a = document.createElement('a');
    a.innerHTML = name;
    on('click', a, () => { openSection(sectionId); });
    li.appendChild(a);
    return li;
}
function on(event, element, fn) {
    if (element) {
        console.log('on %s: add event listener', event);
        element.addEventListener(event, fn);
    }
}
function openSection(id) {
    console.log('openSection: ', id);
    closeActiveSections();
    const section = document.getElementById(id);
    if (section) {
        console.log('openSection: %s', id);
        section.style.display = 'block';
        section.classList.add('active');
    }
    else {
        console.log('openSection: section %s not found', id);
    }
}
function closeActiveSections() {
    const activeItems = document.getElementsByClassName('active');
    for (let index = 0; index < activeItems.length; index++) {
        const section = activeItems[index];
        section.classList.remove('active');
        section.setAttribute('style', 'display:none');
    }
}
const sensors = [];
// let settings = [];
const url = 'ws://' + document.domain;
let socket = new WebSocket(url);
socket.onopen = function () {
    setConnectionStatus(true);
    socket.send(JSON.stringify({ command: 'getSensors' }));
    socket.send(JSON.stringify({ command: 'getSettings' }));
};
socket.onmessage = function (event) {
    setConnectionStatus(true);
    const msg = JSON.parse(event.data);
    switch (msg.command) {
        case 'sensors':
            receiveSensors(msg.data);
            if (!isMonitoring) {
                startMonitor(sensors);
            }
            break;
        case 'settings':
            receiveSettings(msg.data);
            break;
        case 'log':
            log(msg.data);
            break;
    }
};
socket.onclose = function () {
    setConnectionStatus(false);
    clearTimeout(logTimer);
    logTimer = setInterval(clearSensorValue, 5000);
};
socket.onerror = function () {
    setConnectionStatus(false);
    clearTimeout(logTimer);
    logTimer = setInterval(clearSensorValue, 5000);
};
function sensorName(desc) {
    return desc.SN + ', port ' + desc.port;
}
function sensorId(desc) {
    const sn = desc.SN.replace(' ', desc.SN);
    const id = desc.SN.replace(' ', desc.SN) + '-' + desc.port;
    return id;
}
function receiveSensors(sensors) {
    const section = document.getElementById('sensorSection');
    for (const sensor of sensors) {
        const article = document.createElement('article');
        const heading = document.createElement('h3');
        heading.id = sensorId(sensor.desc) + '-value';
        article.appendChild(heading);
        const desc = document.createElement('p');
        desc.id = sensorId(sensor.desc);
        article.appendChild(desc);
        if (section) {
            section.appendChild(article);
        }
    }
    log(sensors);
}
let isMonitoring = false;
function setMonitoringButton() {
    const button = document.getElementById('monitor');
    if (!button) {
        return;
    }
    if (isMonitoring) {
        button.innerHTML = 'Stop monitor';
        button.classList.add('isMonitoring');
    }
    else {
        button.innerHTML = 'Start Monitor';
        button.classList.remove('isMonitoring');
    }
}
function startMonitor(sensors) {
    isMonitoring = true;
    setMonitoringButton();
    const command = 'startMonitor';
    const data = [];
    for (const sensor of sensors) {
        data.push(sensor.desc);
    }
    socket.send(JSON.stringify({ command, data }));
}
function stopMonitor(sensors) {
    isMonitoring = false;
    setMonitoringButton();
    const command = 'stopMonitor';
    const data = [];
    for (const sensor of sensors) {
        data.push(sensor.desc);
    }
    socket.send(JSON.stringify({ command, data }));
}
let logTimer;
function log(sensorData) {
    for (const sensor of sensorData) {
        const log = document.getElementById(sensorId(sensor.desc) + '-value');
        if (log) {
            const date = new Date(sensor.samples[0].date);
            const value = sensor.samples[0].value;
            log.innerHTML = value + ' °C';
        }
        const desc = document.getElementById(sensorId(sensor.desc));
        if (desc) {
            const date = new Date(sensor.samples[0].date);
            const value = sensor.samples[0].value;
            desc.innerHTML = 'by ' + sensorName(sensor.desc) + ': ' +
                date.toLocaleDateString() + ', ' + date.toLocaleTimeString() + '. model: ' + sensor.attr.model;
        }
        clearTimeout(logTimer);
        logTimer = setInterval(clearSensorValue, 3000);
    }
}
class HTMLSetting {
    constructor(setting) {
        this.name = setting.name;
        this.label = setting.label;
        this.value = setting.value;
        this.defaultValue = setting.defaultValue;
        this.text = setting.text;
        this.readonly = setting.readonly;
        this.input = document.getElementById(name + 'value');
        this.backstore = this.value.toString();
        this.editBtn = document.getElementById(name + 'edit');
        this.SaveBtn = document.getElementById(name + 'save');
    }
    static create(setting) {
        if (!HTMLSetting.has(setting.name)) {
            const newSetting = new HTMLSetting(setting);
            HTMLSetting.settings.push(newSetting);
            return newSetting;
        }
        else {
            console.error('HTMLSetting.create: setting exists ', setting.name);
            throw Error();
        }
    }
    static find(name) {
        for (const setting of HTMLSetting.settings) {
            if (setting.name === name) {
                return setting;
            }
        }
        console.error('Setting.find: setting "%s" not found', name);
        console.log('HTMLSetting.get: length=', HTMLSetting.settings.length);
        throw Error();
    }
    static has(name) {
        for (const setting of HTMLSetting.settings) {
            if (setting.name === name) {
                return true;
            }
        }
        return false;
    }
    editSetting() {
        this.backstore = this.input.value;
        this.input.readOnly = true;
        this.input.classList.remove('settingReadonly');
        this.input.classList.add('settingEdit');
        this.editBtn.innerHTML = 'Avbryt';
        this.editBtn.classList.remove('settingReadonly');
        this.editBtn.classList.add('settingEdit');
        this.SaveBtn.setAttribute('style', 'display:block');
    }
    readonlySetting() {
        this.input.value = this.backstore;
        this.input.readOnly = false;
        this.input.classList.remove('settingEdit');
        this.input.classList.add('settingReadonly');
        this.editBtn.innerHTML = 'Ändra';
        this.editBtn.classList.remove('settingEdit');
        this.editBtn.classList.add('settingReadonly');
        this.SaveBtn.setAttribute('style', 'display:none');
    }
    saveSetting() {
        if (this.backstore !== this.input.value) {
            this.backstore = this.input.value;
        }
        this.readonlySetting();
    }
}
HTMLSetting.settings = [];
function addSetting(setting, section) {
    console.log('addSetting: ' + setting.name);
    // Get the contents of the template
    const template = document.getElementById('template-setting');
    if (!template) {
        console.error('addSetting: template missing');
        return;
    }
    const templateHtml = template.innerHTML;
    // replace placeholder tags
    // with actual data, and generate final HTML
    const html = templateHtml.replace(/{{name}}/g, setting.name)
        .replace(/{{label}}/g, setting.label)
        .replace(/{{text}}/g, setting.text)
        .replace(/{{value}}/g, setting.value.toString());
    const article = document.createElement('article');
    article.innerHTML = html;
    section.appendChild(article);
    const editBtn = document.getElementById(setting.name + 'edit');
    const saveBtn = document.getElementById(setting.name + 'save');
    if (setting.readonly) {
        editBtn.style.display = 'none';
        saveBtn.style.display = 'none';
    }
    else {
        on('click', editBtn, () => {
            clickedEdit(setting.name);
        });
        on('click', saveBtn, () => {
            clickedSaved(setting.name);
        });
    }
    const settingDOM = HTMLSetting.create(setting);
}
function updateSetting(setting) {
    console.log('updateSetting: ' + setting.name);
    const input = document.getElementById(setting.name + 'value');
    const readonly = input.readOnly;
    input.readOnly = false;
    input.value = setting.value.toString();
    input.readOnly = readonly;
}
function editSetting(name) {
    const input = document.getElementById(name + 'value');
    const editBtn = document.getElementById(name + 'edit');
    const SaveBtn = document.getElementById(name + 'save');
    input.readOnly = false;
    input.classList.remove('settingReadonly');
    input.classList.add('settingEdit');
    editBtn.innerHTML = 'Cancel';
    SaveBtn.setAttribute('style', 'display:block');
}
function clickedEdit(name) {
    const setting = HTMLSetting.find(name);
    const input = document.getElementById(name + 'value');
    if (input.readOnly) {
        console.log('edit:', name);
        editSetting(name);
    }
    else {
        console.log('cancel:', name);
        readonlySetting(name);
    }
}
function clickedSaved(name) {
    console.log('clickedSaved:');
    const input = document.getElementById(name + 'value');
    const SaveBtn = document.getElementById(name + 'save');
    const setting = HTMLSetting.find(name);
    if (!input || !setting || !SaveBtn) {
        console.error('clickedSaved: could not find all HTML element');
        return;
    }
    setting.backstore = input.value;
    setting.value = input.value;
    SaveBtn.setAttribute('style', 'display:none');
    readonlySetting(name);
    socket.send(JSON.stringify({ command: 'saveSetting', data: setting }));
}
function readonlySetting(name) {
    const input = document.getElementById(name + 'value');
    const editBtn = document.getElementById(name + 'edit');
    const SaveBtn = document.getElementById(name + 'save');
    const setting = HTMLSetting.find(name);
    input.classList.remove('settingEdit');
    input.classList.add('settingReadonly');
    editBtn.innerHTML = 'Edit';
    editBtn.blur();
    input.value = setting.backstore;
    input.readOnly = true;
    SaveBtn.setAttribute('style', 'display:none');
}
function receiveSettings(allSettings) {
    const section = document.getElementById('settingsSection');
    for (const setting of allSettings) {
        if (HTMLSetting.has(setting.name)) {
            updateSetting(setting);
        }
        else {
            addSetting(setting, section);
        }
    }
}
function setConnectionStatus(connected) {
    const status = document.getElementById('connection');
    isMonitoring = connected && isMonitoring;
    setMonitoringButton();
    if (status && connected && isMonitoring) {
        status.innerHTML = ' (live)';
    }
    else if (status && connected) {
        status.innerHTML = ' (Connected)';
    }
    else if (status) {
        status.innerHTML = ' (Disconnected)';
    }
}
function monitor() {
    if (isMonitoring) {
        stopMonitor(sensors);
    }
    else {
        startMonitor(sensors);
    }
}
function clearSensorValue() {
    for (const sensor of sensors) {
        const sampleDate = sensor.samples[0].date;
        if (Date.now() - sampleDate > 60000) {
            const sensorValue = document.getElementById(sensorId(sensor.desc));
            if (sensorValue) {
                sensorValue.innerHTML = 'No sensor data received last 60 seconds';
            }
        }
    }
    setConnectionStatus(socket.readyState === socket.OPEN);
    if (socket.readyState === socket.CLOSED) {
        socket = new WebSocket(url);
    }
}
function round(value, precision) {
    //    precision || (precision = 1);
    const inverse = 1.0 / precision;
    return Math.round(value * inverse) / inverse;
}
},{}]},{},[1])
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJzcmMvYnJvd3Nlci9jbGllbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUNJQSxJQUFJLEVBQUUsQ0FBQztBQUVQLFNBQVMsSUFBSTtJQUNULFFBQVEsRUFBRSxDQUFDO0lBQ1gsV0FBVyxDQUFDLGVBQWUsQ0FBQyxDQUFDO0lBQzdCLE1BQU0sVUFBVSxHQUFHLFFBQVEsQ0FBQyxjQUFjLENBQUMsU0FBUyxDQUFDLENBQUM7SUFDdEQsRUFBRSxDQUFDLE9BQU8sRUFBRSxVQUFVLEVBQUcsR0FBRSxFQUFFLEdBQUcsT0FBTyxFQUFFLENBQUMsQ0FBQSxDQUFDLENBQUMsQ0FBQztBQUNqRCxDQUFDO0FBRUQsU0FBUyxRQUFRO0lBQ2IsTUFBTSxJQUFJLEdBQUcsUUFBUSxDQUFDLGNBQWMsQ0FBQyxNQUFNLENBQUMsQ0FBQztJQUM3QyxPQUFPLENBQUMsR0FBRyxDQUFDLFlBQVksQ0FBQyxDQUFDO0lBQzFCLElBQUksQ0FBQyxXQUFXLENBQUMsUUFBUSxDQUFDLFNBQVMsRUFBQyxlQUFlLENBQUMsQ0FBQyxDQUFDO0lBQ3RELElBQUksQ0FBQyxXQUFXLENBQUMsUUFBUSxDQUFDLFVBQVUsRUFBQyxpQkFBaUIsQ0FBQyxDQUFDLENBQUM7QUFDN0QsQ0FBQztBQUVELFNBQVMsUUFBUSxDQUFDLElBQVksRUFBRSxTQUFpQjtJQUM3QyxPQUFPLENBQUMsR0FBRyxDQUFDLGlDQUFpQyxFQUFFLElBQUksRUFBRSxTQUFTLENBQUMsQ0FBQztJQUNoRSxNQUFNLEVBQUUsR0FBRyxRQUFRLENBQUMsYUFBYSxDQUFDLElBQUksQ0FBQyxDQUFDO0lBQ3hDLE1BQU0sQ0FBQyxHQUFHLFFBQVEsQ0FBQyxhQUFhLENBQUMsR0FBRyxDQUFDLENBQUM7SUFDdEMsQ0FBQyxDQUFDLFNBQVMsR0FBRyxJQUFJLENBQUM7SUFDbkIsRUFBRSxDQUFDLE9BQU8sRUFBRSxDQUFDLEVBQUUsR0FBRSxF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LEVBQUU7UUFDckMsTUFBTSxHQUFHLElBQUksU0FBUyxDQUFDLEdBQUcsQ0FBQyxDQUFDO0tBQy9CO0FBQ0wsQ0FBQztBQUVELFNBQVMsS0FBSyxDQUFDLEtBQWEsRUFBRSxTQUFpQjtJQUMzQyxtQ0FBbUM7SUFDbkMsTUFBTSxPQUFPLEdBQUcsR0FBRyxHQUFHLFNBQVMsQ0FBQztJQUNoQyxPQUFPLElBQUksQ0FBQyxLQUFLLENBQUMsS0FBSyxHQUFHLE9BQU8sQ0FBQyxHQUFHLE9BQU8sQ0FBQztBQUNqRCxDQUFDIiwiZmlsZSI6ImdlbmVyYXRlZC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24oKXtmdW5jdGlvbiByKGUsbix0KXtmdW5jdGlvbiBvKGksZil7aWYoIW5baV0pe2lmKCFlW2ldKXt2YXIgYz1cImZ1bmN0aW9uXCI9PXR5cGVvZiByZXF1aXJlJiZyZXF1aXJlO2lmKCFmJiZjKXJldHVybiBjKGksITApO2lmKHUpcmV0dXJuIHUoaSwhMCk7dmFyIGE9bmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIitpK1wiJ1wiKTt0aHJvdyBhLmNvZGU9XCJNT0RVTEVfTk9UX0ZPVU5EXCIsYX12YXIgcD1uW2ldPXtleHBvcnRzOnt9fTtlW2ldWzBdLmNhbGwocC5leHBvcnRzLGZ1bmN0aW9uKHIpe3ZhciBuPWVbaV1bMV1bcl07cmV0dXJuIG8obnx8cil9LHAscC5leHBvcnRzLHIsZSxuLHQpfXJldHVybiBuW2ldLmV4cG9ydHN9Zm9yKHZhciB1PVwiZnVuY3Rpb25cIj09dHlwZW9mIHJlcXVpcmUmJnJlcXVpcmUsaT0wO2k8dC5sZW5ndGg7aSsrKW8odFtpXSk7cmV0dXJuIG99cmV0dXJuIHJ9KSgpIiwiaW1wb3J0IHsgc2V0dGluZ3MgfSBmcm9tICdjbHVzdGVyJztcclxuXHJcbmltcG9ydCB7U2Vuc29yQXR0cmlidXRlc30gZnJvbSAnLi8uLi9tb2RlbHMvc2Vuc29yLWF0dHJpYnV0ZXMnO1xyXG5cclxuaW5pdCgpO1xyXG5cclxuZnVuY3Rpb24gaW5pdCgpIHtcclxuICAgIGluaXRNZW51KCk7XHJcbiAgICBvcGVuU2VjdGlvbignc2Vuc29yU2VjdGlvbicpO1xyXG4gICAgY29uc3QgbW9uaXRvckJ0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtb25pdG9yJyk7XHJcbiAgICBvbignY2xpY2snLCBtb25pdG9yQnRuLCAgKCk9PiB7IG1vbml0b3IoKTt9KTtcclxufVxyXG5cclxuZnVuY3Rpb24gaW5pdE1lbnUoKSB7XHJcbiAgICBjb25zdCBtZW51ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21lbnUnKTtcclxuICAgIGNvbnNvbGUubG9nKCdpbml0TWVudSgpJyk7XHJcbiAgICBtZW51LmFwcGVuZENoaWxkKG1lbnVJdGVtKCdTZW5zb3JzJywnc2Vuc29yU2VjdGlvbicpKTtcclxuICAgIG1lbnUuYXBwZW5kQ2hpbGQobWVudUl0ZW0oJ1NldHRpbmdzJywnc2V0dGluZ3NTZWN0aW9uJykpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBtZW51SXRlbShuYW1lOiBzdHJpbmcsIHNlY3Rpb25JZDogc3RyaW5nKTogSFRNTEVsZW1lbnQge1xyXG4gICAgY29uc29sZS5sb2coJ21lbnVJdGVtOiBuYW1lPSVzLCBzZWN0aW9uSWQ9JXMnLCBuYW1lLCBzZWN0aW9uSWQpO1xyXG4gICAgY29uc3QgbGkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdsaScpO1xyXG4gICAgY29uc3QgYSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EnKTtcclxuICAgIGEuaW5uZXJIVE1MID0gbmFtZTtcclxuICAgIG9uKCdjbGljaycsIGEsICgpPT4geyBvcGVuU2VjdGlvbihzZWN0aW9uSWQpO30pO1xyXG5cclxuICAgIGxpLmFwcGVuZENoaWxkKGEpO1xyXG4gICAgcmV0dXJuIGxpO1xyXG59XHJcblxyXG5cclxuZnVuY3Rpb24gb24oZXZlbnQ6IHN0cmluZywgZWxlbWVudDogSFRNTEVsZW1lbnQgfCBudWxsLCBmbjogKCkgPT4gdm9pZCkge1xyXG4gICAgaWYgKGVsZW1lbnQpIHtcclxuICAgICAgICBjb25zb2xlLmxvZygnb24gJXM6IGFkZCBldmVudCBsaXN0ZW5lcicsIGV2ZW50KTtcclxuICAgICAgICBlbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoZXZlbnQsIGZuKTtcclxuICAgIH1cclxufVxyXG5cclxuZnVuY3Rpb24gb3BlblNlY3Rpb24oaWQ6IHN0cmluZykge1xyXG4gICAgY29uc29sZS5sb2coJ29wZW5TZWN0aW9uOiAnLCBpZCk7XHJcbiAgICBjbG9zZUFjdGl2ZVNlY3Rpb25zKCk7XHJcbiAgICBjb25zdCBzZWN0aW9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoaWQpO1xyXG4gICAgaWYgKHNlY3Rpb24pIHtcclxuICAgICAgICBjb25zb2xlLmxvZygnb3BlblNlY3Rpb246ICVzJywgaWQpO1xyXG4gICAgICAgIHNlY3Rpb24uc3R5bGUuZGlzcGxheSA9ICdibG9jayc7XHJcbiAgICAgICAgc2VjdGlvbi5jbGFzc0xpc3QuYWRkKCdhY3RpdmUnKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgY29uc29sZS5sb2coJ29wZW5TZWN0aW9uOiBzZWN0aW9uICVzIG5vdCBmb3VuZCcsIGlkKTtcclxuICAgIH1cclxuXHJcbn1cclxuXHJcbmZ1bmN0aW9uIGNsb3NlQWN0aXZlU2VjdGlvbnMoKSB7XHJcbiAgICBjb25zdCBhY3RpdmVJdGVtcyA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ2FjdGl2ZScpO1xyXG5cclxuICAgIGZvciAobGV0IGluZGV4ID0gMDsgaW5kZXggPCBhY3RpdmVJdGVtcy5sZW5ndGg7IGluZGV4KyspIHtcclxuICAgICAgICBjb25zdCBzZWN0aW9uID0gYWN0aXZlSXRlbXNbaW5kZXhdO1xyXG4gICAgICAgIHNlY3Rpb24uY2xhc3NMaXN0LnJlbW92ZSgnYWN0aXZlJyk7XHJcbiAgICAgICAgc2VjdGlvbi5zZXRBdHRyaWJ1dGUoJ3N0eWxlJywgJ2Rpc3BsYXk6bm9uZScpO1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIFNlbnNvckRlc2NyaXB0aW9uIHtcclxuICAgIFNOOiBzdHJpbmc7XHJcbiAgICBwb3J0OiBudW1iZXI7XHJcbn1cclxuZXhwb3J0IGludGVyZmFjZSBTZW5zb3JTYW1wbGUge1xyXG4gICAgdmFsdWU6IG51bWJlcjtcclxuICAgIGRhdGU6IG51bWJlcjtcclxufVxyXG5leHBvcnQgaW50ZXJmYWNlIFNlbnNvckxvZyB7XHJcbiAgICBkZXNjOiBTZW5zb3JEZXNjcmlwdGlvbjtcclxuICAgIGF0dHI6IFNlbnNvckF0dHJpYnV0ZXM7XHJcbiAgICBzYW1wbGVzOiBTZW5zb3JTYW1wbGVbXTtcclxufVxyXG5leHBvcnQgdHlwZSBTZXR0aW5nVmFsdWUgPSBzdHJpbmcgfCBudW1iZXI7XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIFNldHRpbmcge1xyXG4gICAgbmFtZTogc3RyaW5nO1xyXG4gICAgbGFiZWw6IHN0cmluZztcclxuICAgIHZhbHVlOiBTZXR0aW5nVmFsdWU7XHJcbiAgICBkZWZhdWx0VmFsdWU6IFNldHRpbmdWYWx1ZTtcclxuICAgIHRleHQ6IHN0cmluZztcclxuICAgIHJlYWRvbmx5OiBib29sZWFuO1xyXG59XHJcblxyXG5jb25zdCBzZW5zb3JzOiBTZW5zb3JMb2dbXSA9IFtdO1xyXG4vLyBsZXQgc2V0dGluZ3MgPSBbXTtcclxuXHJcbmNvbnN0IHVybCA9ICd3czovLycgKyBkb2N1bWVudC5kb21haW47XHJcbmxldCBzb2NrZXQgPSBuZXcgV2ViU29ja2V0KHVybCk7XHJcbnNvY2tldC5vbm9wZW4gPSBmdW5jdGlvbigpIHtcclxuICAgIHNldENvbm5lY3Rpb25TdGF0dXModHJ1ZSk7XHJcbiAgICBzb2NrZXQuc2VuZChKU09OLnN0cmluZ2lmeSh7Y29tbWFuZDogJ2dldFNlbnNvcnMnfSkpO1xyXG4gICAgc29ja2V0LnNlbmQoSlNPTi5zdHJpbmdpZnkoe2NvbW1hbmQ6ICdnZXRTZXR0aW5ncyd9KSk7XHJcbn07XHJcblxyXG5zb2NrZXQub25tZXNzYWdlID0gZnVuY3Rpb24oZXZlbnQpIHtcclxuICAgIHNldENvbm5lY3Rpb25TdGF0dXModHJ1ZSk7XHJcbiAgICBjb25zdCBtc2cgPSBKU09OLnBhcnNlKGV2ZW50LmRhdGEpO1xyXG4gICAgc3dpdGNoKG1zZy5jb21tYW5kKSB7XHJcbiAgICAgICAgY2FzZSAnc2Vuc29ycyc6XHJcbiAgICAgICAgICAgIHJlY2VpdmVTZW5zb3JzKG1zZy5kYXRhKTtcclxuICAgICAgICAgICAgaWYgKCFpc01vbml0b3JpbmcpIHtcclxuICAgICAgICAgICAgICAgIHN0YXJ0TW9uaXRvcihzZW5zb3JzKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICBjYXNlICdzZXR0aW5ncyc6XHJcbiAgICAgICAgICAgIHJlY2VpdmVTZXR0aW5ncyhtc2cuZGF0YSk7XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIGNhc2UgJ2xvZyc6XHJcbiAgICAgICAgICAgIGxvZyhtc2cuZGF0YSk7XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICB9XHJcbn07XHJcblxyXG5zb2NrZXQub25jbG9zZSA9IGZ1bmN0aW9uKCkge1xyXG4gICAgc2V0Q29ubmVjdGlvblN0YXR1cyhmYWxzZSk7XHJcbiAgICBjbGVhclRpbWVvdXQobG9nVGltZXIpO1xyXG4gICAgbG9nVGltZXIgPSBzZXRJbnRlcnZhbChjbGVhclNlbnNvclZhbHVlLCA1MDAwKTtcclxufTtcclxuXHJcbnNvY2tldC5vbmVycm9yID0gZnVuY3Rpb24oKSB7XHJcbiAgICBzZXRDb25uZWN0aW9uU3RhdHVzKGZhbHNlKTtcclxuICAgIGNsZWFyVGltZW91dChsb2dUaW1lcik7XHJcbiAgICBsb2dUaW1lciA9IHNldEludGVydmFsKGNsZWFyU2Vuc29yVmFsdWUsIDUwMDApO1xyXG59O1xyXG5cclxuXHJcblxyXG5mdW5jdGlvbiBzZW5zb3JOYW1lKGRlc2M6IFNlbnNvckRlc2NyaXB0aW9uKTogc3RyaW5nIHtcclxuICAgIHJldHVybiBkZXNjLlNOICsgJywgcG9ydCAnICsgZGVzYy5wb3J0O1xyXG59XHJcblxyXG5mdW5jdGlvbiBzZW5zb3JJZChkZXNjOiBTZW5zb3JEZXNjcmlwdGlvbik6IHN0cmluZyB7XHJcbiAgICBjb25zdCBzbiA9IGRlc2MuU04ucmVwbGFjZSgnICcsIGRlc2MuU04pO1xyXG4gICAgY29uc3QgaWQgPSBkZXNjLlNOLnJlcGxhY2UoJyAnLCBkZXNjLlNOKSArICctJyArIGRlc2MucG9ydDtcclxuICAgIHJldHVybiBpZDtcclxufVxyXG5cclxuZnVuY3Rpb24gcmVjZWl2ZVNlbnNvcnMoc2Vuc29yczogU2Vuc29yTG9nW10pIHtcclxuICAgIGNvbnN0IHNlY3Rpb24gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2Vuc29yU2VjdGlvbicpO1xyXG4gICAgZm9yIChjb25zdCBzZW5zb3Igb2Ygc2Vuc29ycykge1xyXG4gICAgICAgIGNvbnN0IGFydGljbGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhcnRpY2xlJyk7XHJcbiAgICAgICAgY29uc3QgaGVhZGluZyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2gzJyk7XHJcblxyXG4gICAgICAgIGhlYWRpbmcuaWQgPSBzZW5zb3JJZChzZW5zb3IuZGVzYykgKyAnLXZhbHVlJztcclxuICAgICAgICBhcnRpY2xlLmFwcGVuZENoaWxkKGhlYWRpbmcpO1xyXG5cclxuICAgICAgICBjb25zdCBkZXNjID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgncCcpO1xyXG4gICAgICAgIGRlc2MuaWQgPSBzZW5zb3JJZChzZW5zb3IuZGVzYyk7XHJcbiAgICAgICAgYXJ0aWNsZS5hcHBlbmRDaGlsZChkZXNjKTtcclxuICAgICAgICBpZiAoc2VjdGlvbikge1xyXG4gICAgICAgICAgICBzZWN0aW9uLmFwcGVuZENoaWxkKGFydGljbGUpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGxvZyhzZW5zb3JzKTtcclxufVxyXG5sZXQgaXNNb25pdG9yaW5nID0gZmFsc2U7XHJcbmZ1bmN0aW9uIHNldE1vbml0b3JpbmdCdXR0b24oKSB7XHJcbiAgICBjb25zdCBidXR0b24gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbW9uaXRvcicpO1xyXG4gICAgaWYgKCFidXR0b24pIHsgcmV0dXJuOyB9XHJcbiAgICBpZiAoaXNNb25pdG9yaW5nKSB7XHJcbiAgICAgICAgYnV0dG9uLmlubmVySFRNTCA9ICdTdG9wIG1vbml0b3InO1xyXG4gICAgICAgIGJ1dHRvbi5jbGFzc0xpc3QuYWRkKCdpc01vbml0b3JpbmcnKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgYnV0dG9uLmlubmVySFRNTCA9ICdTdGFydCBNb25pdG9yJztcclxuICAgICAgICBidXR0b24uY2xhc3NMaXN0LnJlbW92ZSgnaXNNb25pdG9yaW5nJyk7XHJcbiAgICB9XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHN0YXJ0TW9uaXRvcihzZW5zb3JzOiBTZW5zb3JMb2dbXSkge1xyXG4gICAgaXNNb25pdG9yaW5nID0gdHJ1ZTtcclxuICAgIHNldE1vbml0b3JpbmdCdXR0b24oKTtcclxuICAgIGNvbnN0IGNvbW1hbmQgPSAnc3RhcnRNb25pdG9yJztcclxuICAgIGNvbnN0IGRhdGE6IGFueSA9IFtdO1xyXG4gICAgZm9yIChjb25zdCBzZW5zb3Igb2Ygc2Vuc29ycykge1xyXG4gICAgICAgIGRhdGEucHVzaChzZW5zb3IuZGVzYyk7XHJcbiAgICB9XHJcbiAgICBzb2NrZXQuc2VuZChKU09OLnN0cmluZ2lmeSh7Y29tbWFuZCwgZGF0YX0pKTtcclxufVxyXG5cclxuZnVuY3Rpb24gc3RvcE1vbml0b3Ioc2Vuc29yczogU2Vuc29yTG9nW10pIHtcclxuICAgIGlzTW9uaXRvcmluZyA9IGZhbHNlO1xyXG4gICAgc2V0TW9uaXRvcmluZ0J1dHRvbigpO1xyXG4gICAgY29uc3QgY29tbWFuZCA9ICdzdG9wTW9uaXRvcic7XHJcbiAgICBjb25zdCBkYXRhOiBhbnkgPSBbXTtcclxuICAgIGZvciAoY29uc3Qgc2Vuc29yIG9mIHNlbnNvcnMpIHtcclxuICAgICAgICBkYXRhLnB1c2goc2Vuc29yLmRlc2MpO1xyXG4gICAgfVxyXG4gICAgc29ja2V0LnNlbmQoSlNPTi5zdHJpbmdpZnkoe2NvbW1hbmQsIGRhdGF9KSk7XHJcbn1cclxubGV0IGxvZ1RpbWVyOiBhbnk7XHJcbmZ1bmN0aW9uIGxvZyhzZW5zb3JEYXRhOiBTZW5zb3JMb2dbXSkge1xyXG4gICAgZm9yIChjb25zdCBzZW5zb3Igb2Ygc2Vuc29yRGF0YSkge1xyXG4gICAgICAgIGNvbnN0IGxvZyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHNlbnNvcklkKHNlbnNvci5kZXNjKSArICctdmFsdWUnKTtcclxuICAgICAgICBpZiAobG9nKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGRhdGUgPSBuZXcgRGF0ZShzZW5zb3Iuc2FtcGxlc1swXS5kYXRlKTtcclxuICAgICAgICAgICAgY29uc3QgdmFsdWUgPSBzZW5zb3Iuc2FtcGxlc1swXS52YWx1ZTtcclxuICAgICAgICAgICAgbG9nLmlubmVySFRNTCA9IHZhbHVlICsgJyDCsEMnO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjb25zdCBkZXNjID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoc2Vuc29ySWQoc2Vuc29yLmRlc2MpKTtcclxuICAgICAgICBpZiAoZGVzYykge1xyXG4gICAgICAgICAgICBjb25zdCBkYXRlID0gbmV3IERhdGUoc2Vuc29yLnNhbXBsZXNbMF0uZGF0ZSk7XHJcbiAgICAgICAgICAgIGNvbnN0IHZhbHVlID0gc2Vuc29yLnNhbXBsZXNbMF0udmFsdWU7XHJcbiAgICAgICAgICAgIGRlc2MuaW5uZXJIVE1MID0gJ2J5ICcgKyBzZW5zb3JOYW1lKHNlbnNvci5kZXNjKSAgKyAnOiAnICtcclxuICAgICAgICAgICAgICAgIGRhdGUudG9Mb2NhbGVEYXRlU3RyaW5nKCkgKyAnLCAnICsgZGF0ZS50b0xvY2FsZVRpbWVTdHJpbmcoKSArICcuIG1vZGVsOiAnICsgc2Vuc29yLmF0dHIubW9kZWw7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNsZWFyVGltZW91dChsb2dUaW1lcik7XHJcbiAgICAgICAgbG9nVGltZXIgPSBzZXRJbnRlcnZhbChjbGVhclNlbnNvclZhbHVlLCAzMDAwKTtcclxuICAgIH1cclxufVxyXG5jbGFzcyBIVE1MU2V0dGluZyBpbXBsZW1lbnRzIFNldHRpbmcge1xyXG4gICAgcHJpdmF0ZSBzdGF0aWMgc2V0dGluZ3M6IEhUTUxTZXR0aW5nW10gPSBbXTtcclxuICAgIHB1YmxpYyB2YWx1ZTogU2V0dGluZ1ZhbHVlO1xyXG4gICAgcHVibGljIGxhYmVsOiBzdHJpbmc7XHJcbiAgICBwdWJsaWMgZGVmYXVsdFZhbHVlOiBTZXR0aW5nVmFsdWU7XHJcbiAgICBwdWJsaWMgdGV4dDogc3RyaW5nO1xyXG4gICAgcHVibGljIHJlYWRvbmx5OiBib29sZWFuO1xyXG4gICAgcHVibGljIG5hbWU6IHN0cmluZztcclxuICAgIHB1YmxpYyBiYWNrc3RvcmU6IHN0cmluZztcclxuICAgIHB1YmxpYyBpbnB1dDogSFRNTElucHV0RWxlbWVudDtcclxuICAgIHB1YmxpYyBlZGl0QnRuOiBIVE1MQnV0dG9uRWxlbWVudDtcclxuICAgIHB1YmxpYyBTYXZlQnRuOiBIVE1MQnV0dG9uRWxlbWVudDtcclxuICAgIGNvbnN0cnVjdG9yKHNldHRpbmc6IFNldHRpbmcpIHtcclxuICAgICAgICB0aGlzLm5hbWUgPSBzZXR0aW5nLm5hbWU7XHJcbiAgICAgICAgdGhpcy5sYWJlbCA9IHNldHRpbmcubGFiZWw7XHJcbiAgICAgICAgdGhpcy52YWx1ZSA9IHNldHRpbmcudmFsdWU7XHJcbiAgICAgICAgdGhpcy5kZWZhdWx0VmFsdWUgPSBzZXR0aW5nLmRlZmF1bHRWYWx1ZTtcclxuICAgICAgICB0aGlzLnRleHQgPSBzZXR0aW5nLnRleHQ7XHJcbiAgICAgICAgdGhpcy5yZWFkb25seSA9IHNldHRpbmcucmVhZG9ubHk7XHJcbiAgICAgICAgdGhpcy5pbnB1dCA9IDxIVE1MSW5wdXRFbGVtZW50PmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKG5hbWUgKyd2YWx1ZScpO1xyXG4gICAgICAgIHRoaXMuYmFja3N0b3JlID0gdGhpcy52YWx1ZS50b1N0cmluZygpO1xyXG4gICAgICAgIHRoaXMuZWRpdEJ0biA9IDxIVE1MQnV0dG9uRWxlbWVudD5kb2N1bWVudC5nZXRFbGVtZW50QnlJZChuYW1lICsnZWRpdCcpO1xyXG4gICAgICAgIHRoaXMuU2F2ZUJ0biA9IDxIVE1MQnV0dG9uRWxlbWVudD5kb2N1bWVudC5nZXRFbGVtZW50QnlJZChuYW1lICsnc2F2ZScpO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBzdGF0aWMgY3JlYXRlKHNldHRpbmc6IFNldHRpbmcpOiBIVE1MU2V0dGluZyB7XHJcbiAgICAgICAgaWYgKCFIVE1MU2V0dGluZy5oYXMgKHNldHRpbmcubmFtZSkpIHtcclxuICAgICAgICAgICAgY29uc3QgbmV3U2V0dGluZyA9IG5ldyBIVE1MU2V0dGluZyhzZXR0aW5nKTtcclxuICAgICAgICAgICAgSFRNTFNldHRpbmcuc2V0dGluZ3MucHVzaChuZXdTZXR0aW5nKTtcclxuICAgICAgICAgICAgcmV0dXJuIG5ld1NldHRpbmc7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgY29uc29sZS5lcnJvcignSFRNTFNldHRpbmcuY3JlYXRlOiBzZXR0aW5nIGV4aXN0cyAnLCBzZXR0aW5nLm5hbWUpO1xyXG4gICAgICAgICAgICB0aHJvdyBFcnJvcigpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHB1YmxpYyBzdGF0aWMgZmluZChuYW1lOiBzdHJpbmcpOiBIVE1MU2V0dGluZyB7XHJcbiAgICAgICAgZm9yIChjb25zdCBzZXR0aW5nIG9mIEhUTUxTZXR0aW5nLnNldHRpbmdzKSB7XHJcbiAgICAgICAgICAgIGlmIChzZXR0aW5nLm5hbWUgPT09IG5hbWUpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBzZXR0aW5nO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ1NldHRpbmcuZmluZDogc2V0dGluZyBcIiVzXCIgbm90IGZvdW5kJywgbmFtZSk7XHJcbiAgICAgICAgY29uc29sZS5sb2coJ0hUTUxTZXR0aW5nLmdldDogbGVuZ3RoPScsIEhUTUxTZXR0aW5nLnNldHRpbmdzLmxlbmd0aCk7XHJcbiAgICAgICAgdGhyb3cgRXJyb3IoKTtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgc3RhdGljIGhhcyhuYW1lOiBzdHJpbmcgKTogYm9vbGVhbiB7XHJcbiAgICAgICAgZm9yIChjb25zdCBzZXR0aW5nIG9mIEhUTUxTZXR0aW5nLnNldHRpbmdzKSB7XHJcbiAgICAgICAgICAgIGlmIChzZXR0aW5nLm5hbWUgPT09IG5hbWUpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuICAgIHB1YmxpYyBlZGl0U2V0dGluZygpIHtcclxuICAgICAgICB0aGlzLmJhY2tzdG9yZSA9ICB0aGlzLmlucHV0LnZhbHVlO1xyXG4gICAgICAgIHRoaXMuaW5wdXQucmVhZE9ubHk9dHJ1ZTtcclxuICAgICAgICB0aGlzLmlucHV0LmNsYXNzTGlzdC5yZW1vdmUoJ3NldHRpbmdSZWFkb25seScpO1xyXG4gICAgICAgIHRoaXMuaW5wdXQuY2xhc3NMaXN0LmFkZCgnc2V0dGluZ0VkaXQnKTtcclxuXHJcbiAgICAgICAgdGhpcy5lZGl0QnRuLmlubmVySFRNTD0nQXZicnl0JztcclxuICAgICAgICB0aGlzLmVkaXRCdG4uY2xhc3NMaXN0LnJlbW92ZSgnc2V0dGluZ1JlYWRvbmx5Jyk7XHJcbiAgICAgICAgdGhpcy5lZGl0QnRuLmNsYXNzTGlzdC5hZGQoJ3NldHRpbmdFZGl0Jyk7XHJcblxyXG4gICAgICAgIHRoaXMuU2F2ZUJ0bi5zZXRBdHRyaWJ1dGUoJ3N0eWxlJywgJ2Rpc3BsYXk6YmxvY2snKTtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgcmVhZG9ubHlTZXR0aW5nKCkge1xyXG4gICAgICAgIHRoaXMuaW5wdXQudmFsdWU9dGhpcy5iYWNrc3RvcmU7XHJcbiAgICAgICAgdGhpcy5pbnB1dC5yZWFkT25seT1mYWxzZTtcclxuICAgICAgICB0aGlzLmlucHV0LmNsYXNzTGlzdC5yZW1vdmUoJ3NldHRpbmdFZGl0Jyk7XHJcbiAgICAgICAgdGhpcy5pbnB1dC5jbGFzc0xpc3QuYWRkKCdzZXR0aW5nUmVhZG9ubHknKTtcclxuXHJcbiAgICAgICAgdGhpcy5lZGl0QnRuLmlubmVySFRNTD0nw4RuZHJhJztcclxuICAgICAgICB0aGlzLmVkaXRCdG4uY2xhc3NMaXN0LnJlbW92ZSgnc2V0dGluZ0VkaXQnKTtcclxuICAgICAgICB0aGlzLmVkaXRCdG4uY2xhc3NMaXN0LmFkZCgnc2V0dGluZ1JlYWRvbmx5Jyk7XHJcblxyXG4gICAgICAgIHRoaXMuU2F2ZUJ0bi5zZXRBdHRyaWJ1dGUoJ3N0eWxlJywgJ2Rpc3BsYXk6bm9uZScpO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBzYXZlU2V0dGluZygpIHtcclxuICAgICAgICBpZiAodGhpcy5iYWNrc3RvcmUgIT09IHRoaXMuaW5wdXQudmFsdWUpIHtcclxuICAgICAgICAgICAgdGhpcy5iYWNrc3RvcmU9dGhpcy5pbnB1dC52YWx1ZTtcclxuICAgICAgICAgfVxyXG4gICAgICAgIHRoaXMucmVhZG9ubHlTZXR0aW5nKCk7XHJcbiAgICB9XHJcbn1cclxuXHJcblxyXG5mdW5jdGlvbiBhZGRTZXR0aW5nKHNldHRpbmc6IFNldHRpbmcsIHNlY3Rpb246IEhUTUxFbGVtZW50KSB7XHJcbiAgICBjb25zb2xlLmxvZygnYWRkU2V0dGluZzogJyArIHNldHRpbmcubmFtZSk7XHJcbiAgICAvLyBHZXQgdGhlIGNvbnRlbnRzIG9mIHRoZSB0ZW1wbGF0ZVxyXG4gICAgY29uc3QgdGVtcGxhdGUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndGVtcGxhdGUtc2V0dGluZycpO1xyXG4gICAgaWYgKCF0ZW1wbGF0ZSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ2FkZFNldHRpbmc6IHRlbXBsYXRlIG1pc3NpbmcnKTtcclxuICAgICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICBjb25zdCB0ZW1wbGF0ZUh0bWwgPSB0ZW1wbGF0ZS5pbm5lckhUTUw7XHJcblxyXG4gICAgLy8gcmVwbGFjZSBwbGFjZWhvbGRlciB0YWdzXHJcbiAgICAvLyB3aXRoIGFjdHVhbCBkYXRhLCBhbmQgZ2VuZXJhdGUgZmluYWwgSFRNTFxyXG5cclxuICAgIGNvbnN0IGh0bWwgPSB0ZW1wbGF0ZUh0bWwucmVwbGFjZSgve3tuYW1lfX0vZywgc2V0dGluZy5uYW1lKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnJlcGxhY2UoL3t7bGFiZWx9fS9nLCBzZXR0aW5nLmxhYmVsKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnJlcGxhY2UoL3t7dGV4dH19L2csIHNldHRpbmcudGV4dClcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5yZXBsYWNlKC97e3ZhbHVlfX0vZywgc2V0dGluZy52YWx1ZS50b1N0cmluZygpKTtcclxuXHJcbiAgICBjb25zdCBhcnRpY2xlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYXJ0aWNsZScpO1xyXG4gICAgYXJ0aWNsZS5pbm5lckhUTUwgPSBodG1sO1xyXG4gICAgc2VjdGlvbi5hcHBlbmRDaGlsZChhcnRpY2xlKTtcclxuICAgIGNvbnN0IGVkaXRCdG4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChzZXR0aW5nLm5hbWUgKyAnZWRpdCcpO1xyXG4gICAgY29uc3Qgc2F2ZUJ0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHNldHRpbmcubmFtZSArICdzYXZlJyk7XHJcbiAgICBpZiAoc2V0dGluZy5yZWFkb25seSkge1xyXG4gICAgICAgIGVkaXRCdG4uc3R5bGUuZGlzcGxheSA9ICdub25lJztcclxuICAgICAgICBzYXZlQnRuLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgIG9uICgnY2xpY2snLCBlZGl0QnRuLCAoKT0+IHtcclxuICAgICAgICAgICAgY2xpY2tlZEVkaXQoc2V0dGluZy5uYW1lKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICBvbiAoJ2NsaWNrJywgc2F2ZUJ0biwgKCk9PiB7XHJcbiAgICAgICAgICAgIGNsaWNrZWRTYXZlZChzZXR0aW5nLm5hbWUpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IHNldHRpbmdET006IEhUTUxTZXR0aW5nID0gIEhUTUxTZXR0aW5nLmNyZWF0ZShzZXR0aW5nKTtcclxufVxyXG5cclxuZnVuY3Rpb24gdXBkYXRlU2V0dGluZyhzZXR0aW5nOiBTZXR0aW5nKSB7XHJcbiAgICBjb25zb2xlLmxvZygndXBkYXRlU2V0dGluZzogJyArIHNldHRpbmcubmFtZSk7XHJcbiAgICBjb25zdCBpbnB1dCA9IDxIVE1MSW5wdXRFbGVtZW50PmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHNldHRpbmcubmFtZSArJ3ZhbHVlJyk7XHJcbiAgICBjb25zdCByZWFkb25seSA9IGlucHV0LnJlYWRPbmx5O1xyXG4gICAgaW5wdXQucmVhZE9ubHk9ZmFsc2U7XHJcbiAgICBpbnB1dC52YWx1ZSA9IHNldHRpbmcudmFsdWUudG9TdHJpbmcoKTtcclxuICAgIGlucHV0LnJlYWRPbmx5ID0gcmVhZG9ubHk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGVkaXRTZXR0aW5nKG5hbWU6IHN0cmluZykge1xyXG4gICAgY29uc3QgaW5wdXQgPSA8SFRNTElucHV0RWxlbWVudD5kb2N1bWVudC5nZXRFbGVtZW50QnlJZChuYW1lICsndmFsdWUnKTtcclxuICAgIGNvbnN0IGVkaXRCdG4gPSA8SFRNTEJ1dHRvbkVsZW1lbnQ+ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQobmFtZSArJ2VkaXQnKTtcclxuICAgIGNvbnN0IFNhdmVCdG4gPSA8SFRNTEJ1dHRvbkVsZW1lbnQ+ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQobmFtZSArJ3NhdmUnKTtcclxuICAgIGlucHV0LnJlYWRPbmx5ID0gZmFsc2U7XHJcbiAgICBpbnB1dC5jbGFzc0xpc3QucmVtb3ZlKCdzZXR0aW5nUmVhZG9ubHknKTtcclxuICAgIGlucHV0LmNsYXNzTGlzdC5hZGQoJ3NldHRpbmdFZGl0Jyk7XHJcblxyXG4gICAgZWRpdEJ0bi5pbm5lckhUTUw9J0NhbmNlbCc7XHJcblxyXG4gICAgU2F2ZUJ0bi5zZXRBdHRyaWJ1dGUoJ3N0eWxlJywgJ2Rpc3BsYXk6YmxvY2snKTtcclxufVxyXG5mdW5jdGlvbiBjbGlja2VkRWRpdChuYW1lOiBzdHJpbmcpIHtcclxuICAgIGNvbnN0IHNldHRpbmcgPSBIVE1MU2V0dGluZy5maW5kKG5hbWUpO1xyXG4gICAgY29uc3QgaW5wdXQ9PEhUTUxJbnB1dEVsZW1lbnQ+ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQobmFtZSArJ3ZhbHVlJyk7XHJcbiAgICBpZiAoaW5wdXQucmVhZE9ubHkpIHtcclxuICAgICAgICBjb25zb2xlLmxvZygnZWRpdDonLCBuYW1lKTtcclxuICAgICAgICBlZGl0U2V0dGluZyhuYW1lKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgY29uc29sZS5sb2coJ2NhbmNlbDonLCBuYW1lKTtcclxuICAgICAgICByZWFkb25seVNldHRpbmcobmFtZSk7XHJcbiAgICB9XHJcbn1cclxuZnVuY3Rpb24gY2xpY2tlZFNhdmVkKG5hbWU6IHN0cmluZykge1xyXG4gICAgY29uc29sZS5sb2coJ2NsaWNrZWRTYXZlZDonKTtcclxuICAgIGNvbnN0IGlucHV0ID0gPEhUTUxJbnB1dEVsZW1lbnQ+ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQobmFtZSArJ3ZhbHVlJyk7XHJcbiAgICBjb25zdCBTYXZlQnRuID0gPEhUTUxCdXR0b25FbGVtZW50PmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKG5hbWUgKydzYXZlJyk7XHJcbiAgICBjb25zdCBzZXR0aW5nOiBIVE1MU2V0dGluZyA9IEhUTUxTZXR0aW5nLmZpbmQobmFtZSk7XHJcbiAgICBpZiAoIWlucHV0IHx8ICFzZXR0aW5nIHx8ICFTYXZlQnRuKSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignY2xpY2tlZFNhdmVkOiBjb3VsZCBub3QgZmluZCBhbGwgSFRNTCBlbGVtZW50Jyk7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgc2V0dGluZy5iYWNrc3RvcmUgPSBpbnB1dC52YWx1ZTtcclxuICAgIHNldHRpbmcudmFsdWUgPSBpbnB1dC52YWx1ZTtcclxuICAgIFNhdmVCdG4uc2V0QXR0cmlidXRlKCdzdHlsZScsICdkaXNwbGF5Om5vbmUnKTtcclxuICAgIHJlYWRvbmx5U2V0dGluZyhuYW1lKTtcclxuICAgIHNvY2tldC5zZW5kKEpTT04uc3RyaW5naWZ5KHtjb21tYW5kOiAnc2F2ZVNldHRpbmcnLCBkYXRhOiA8U2V0dGluZz5zZXR0aW5nfSkpO1xyXG59XHJcblxyXG5mdW5jdGlvbiByZWFkb25seVNldHRpbmcobmFtZTogc3RyaW5nKSB7XHJcbiAgICBjb25zdCBpbnB1dCA9IDxIVE1MSW5wdXRFbGVtZW50PmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKG5hbWUgKyd2YWx1ZScpO1xyXG4gICAgY29uc3QgZWRpdEJ0biA9IDxIVE1MQnV0dG9uRWxlbWVudD5kb2N1bWVudC5nZXRFbGVtZW50QnlJZChuYW1lICsnZWRpdCcpO1xyXG4gICAgY29uc3QgU2F2ZUJ0biA9IDxIVE1MQnV0dG9uRWxlbWVudD5kb2N1bWVudC5nZXRFbGVtZW50QnlJZChuYW1lICsnc2F2ZScpO1xyXG4gICAgY29uc3Qgc2V0dGluZyA9IEhUTUxTZXR0aW5nLmZpbmQobmFtZSk7XHJcblxyXG4gICAgaW5wdXQuY2xhc3NMaXN0LnJlbW92ZSgnc2V0dGluZ0VkaXQnKTtcclxuICAgIGlucHV0LmNsYXNzTGlzdC5hZGQoJ3NldHRpbmdSZWFkb25seScpO1xyXG5cclxuICAgIGVkaXRCdG4uaW5uZXJIVE1MPSdFZGl0JztcclxuXHJcbiAgICBlZGl0QnRuLmJsdXIoKTtcclxuXHJcbiAgICBpbnB1dC52YWx1ZT1zZXR0aW5nLmJhY2tzdG9yZTtcclxuICAgIGlucHV0LnJlYWRPbmx5PXRydWU7XHJcblxyXG4gICAgU2F2ZUJ0bi5zZXRBdHRyaWJ1dGUoJ3N0eWxlJywgJ2Rpc3BsYXk6bm9uZScpO1xyXG59XHJcblxyXG5cclxuZnVuY3Rpb24gcmVjZWl2ZVNldHRpbmdzKGFsbFNldHRpbmdzOiBTZXR0aW5nW10pIHtcclxuICAgIGNvbnN0IHNlY3Rpb24gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2V0dGluZ3NTZWN0aW9uJyk7XHJcbiAgICBmb3IgKGNvbnN0IHNldHRpbmcgb2YgYWxsU2V0dGluZ3MpIHtcclxuICAgICAgICBpZiAoSFRNTFNldHRpbmcuaGFzKHNldHRpbmcubmFtZSkpIHtcclxuICAgICAgICAgICAgdXBkYXRlU2V0dGluZyhzZXR0aW5nKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBhZGRTZXR0aW5nKHNldHRpbmcsIHNlY3Rpb24pO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG5mdW5jdGlvbiBzZXRDb25uZWN0aW9uU3RhdHVzKGNvbm5lY3RlZDogYm9vbGVhbikge1xyXG4gICAgY29uc3Qgc3RhdHVzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Nvbm5lY3Rpb24nKTtcclxuICAgIGlzTW9uaXRvcmluZyA9IGNvbm5lY3RlZCAmJiBpc01vbml0b3Jpbmc7XHJcbiAgICBzZXRNb25pdG9yaW5nQnV0dG9uKCk7XHJcbiAgICBpZiAoc3RhdHVzICYmIGNvbm5lY3RlZCAmJiBpc01vbml0b3JpbmcpIHtcclxuICAgICAgICBzdGF0dXMuaW5uZXJIVE1MID0gJyAobGl2ZSknO1xyXG4gICAgfSBlbHNlIGlmIChzdGF0dXMgJiYgY29ubmVjdGVkKSB7XHJcbiAgICAgICAgc3RhdHVzLmlubmVySFRNTCA9ICcgKENvbm5lY3RlZCknO1xyXG4gICAgfSBlbHNlIGlmIChzdGF0dXMpIHtcclxuICAgICAgICBzdGF0dXMuaW5uZXJIVE1MID0gJyAoRGlzY29ubmVjdGVkKSc7XHJcbiAgICB9XHJcbn1cclxuXHJcbmZ1bmN0aW9uIG1vbml0b3IoKSB7XHJcbiAgICBpZiAoaXNNb25pdG9yaW5nKSB7XHJcbiAgICAgICAgc3RvcE1vbml0b3Ioc2Vuc29ycyk7XHJcblxyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICBzdGFydE1vbml0b3Ioc2Vuc29ycyk7XHJcbiAgICB9XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGNsZWFyU2Vuc29yVmFsdWUoKSB7XHJcbiAgICBmb3IgKGNvbnN0IHNlbnNvciBvZiBzZW5zb3JzKSB7XHJcbiAgICAgICAgY29uc3Qgc2FtcGxlRGF0ZSA9IHNlbnNvci5zYW1wbGVzWzBdLmRhdGU7XHJcbiAgICAgICAgaWYgKERhdGUubm93KCkgLSBzYW1wbGVEYXRlID4gNjBfMDAwKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHNlbnNvclZhbHVlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoc2Vuc29ySWQoc2Vuc29yLmRlc2MpKTtcclxuICAgICAgICAgICAgaWYgKHNlbnNvclZhbHVlKSB7XHJcbiAgICAgICAgICAgICAgICBzZW5zb3JWYWx1ZS5pbm5lckhUTUwgPSAnTm8gc2Vuc29yIGRhdGEgcmVjZWl2ZWQgbGFzdCA2MCBzZWNvbmRzJztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBzZXRDb25uZWN0aW9uU3RhdHVzKHNvY2tldC5yZWFkeVN0YXRlID09PSBzb2NrZXQuT1BFTik7XHJcbiAgICBpZiAoc29ja2V0LnJlYWR5U3RhdGUgPT09IHNvY2tldC5DTE9TRUQpIHtcclxuICAgICAgICBzb2NrZXQgPSBuZXcgV2ViU29ja2V0KHVybCk7XHJcbiAgICB9XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHJvdW5kKHZhbHVlOiBudW1iZXIsIHByZWNpc2lvbjogbnVtYmVyKSB7XHJcbiAgICAvLyAgICBwcmVjaXNpb24gfHwgKHByZWNpc2lvbiA9IDEpO1xyXG4gICAgY29uc3QgaW52ZXJzZSA9IDEuMCAvIHByZWNpc2lvbjtcclxuICAgIHJldHVybiBNYXRoLnJvdW5kKHZhbHVlICogaW52ZXJzZSkgLyBpbnZlcnNlO1xyXG59XHJcbiJdfQ==
