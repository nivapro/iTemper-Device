(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){
init();
function init() {
    initMenu();
    openSection('sensorSection');
    const monitorBtn = document.getElementById('monitor');
    on('click', monitorBtn, () => { monitor(); });
}
function initMenu() {
    const menu = document.getElementById('menu');
    console.log('initMenu()');
    menu.appendChild(menuItem('Sensors', 'sensorSection'));
    menu.appendChild(menuItem('Settings', 'settingsSection'));
}
function menuItem(name, sectionId) {
    console.log('menuItem: name=%s, sectionId=%s', name, sectionId);
    const li = document.createElement('li');
    const a = document.createElement('a');
    a.innerHTML = name;
    on('click', a, () => { openSection(sectionId); });
    li.appendChild(a);
    return li;
}
function on(event, element, fn) {
    if (element) {
        console.log('on %s: add event listener', event);
        element.addEventListener(event, fn);
    }
}
function openSection(id) {
    console.log('openSection: ', id);
    closeActiveSections();
    const section = document.getElementById(id);
    if (section) {
        console.log('openSection: %s', id);
        section.style.display = 'block';
        section.classList.add('active');
    }
    else {
        console.log('openSection: section %s not found', id);
    }
}
function closeActiveSections() {
    const activeItems = document.getElementsByClassName('active');
    for (let index = 0; index < activeItems.length; index++) {
        const section = activeItems[index];
        section.classList.remove('active');
        section.setAttribute('style', 'display:none');
    }
}
const sensors = [];
// let settings = [];
const url = 'ws://' + document.domain;
let socket = new WebSocket(url);
socket.onopen = function () {
    setConnectionStatus(true);
    socket.send(JSON.stringify({ command: 'getSensors' }));
    socket.send(JSON.stringify({ command: 'getSettings' }));
};
socket.onmessage = function (event) {
    setConnectionStatus(true);
    const msg = JSON.parse(event.data);
    switch (msg.command) {
        case 'sensors':
            receiveSensors(msg.data);
            if (!isMonitoring) {
                startMonitor(sensors);
            }
            break;
        case 'settings':
            receiveSettings(msg.data);
            break;
        case 'log':
            log(msg.data);
            break;
    }
};
socket.onclose = function () {
    setConnectionStatus(false);
    clearTimeout(logTimer);
    logTimer = setInterval(clearSensorValue, 5000);
};
socket.onerror = function () {
    setConnectionStatus(false);
    clearTimeout(logTimer);
    logTimer = setInterval(clearSensorValue, 5000);
};
function sensorName(desc) {
    return desc.SN + ', port ' + desc.port;
}
function sensorId(desc) {
    const sn = desc.SN.replace(' ', desc.SN);
    const id = desc.SN.replace(' ', desc.SN) + '-' + desc.port;
    return id;
}
function receiveSensors(sensors) {
    const section = document.getElementById('sensorSection');
    for (const sensor of sensors) {
        const article = document.createElement('article');
        const heading = document.createElement('h3');
        heading.id = sensorId(sensor.desc) + '-value';
        article.appendChild(heading);
        const desc = document.createElement('p');
        desc.id = sensorId(sensor.desc);
        article.appendChild(desc);
        if (section) {
            section.appendChild(article);
        }
    }
    log(sensors);
}
let isMonitoring = false;
function setMonitoringButton() {
    const button = document.getElementById('monitor');
    if (!button) {
        return;
    }
    if (isMonitoring) {
        button.innerHTML = 'Stop monitor';
        button.classList.add('isMonitoring');
    }
    else {
        button.innerHTML = 'Start Monitor';
        button.classList.remove('isMonitoring');
    }
}
function startMonitor(sensors) {
    isMonitoring = true;
    setMonitoringButton();
    const command = 'startMonitor';
    const data = [];
    for (const sensor of sensors) {
        data.push(sensor.desc);
    }
    socket.send(JSON.stringify({ command, data }));
}
function stopMonitor(sensors) {
    isMonitoring = false;
    setMonitoringButton();
    const command = 'stopMonitor';
    const data = [];
    for (const sensor of sensors) {
        data.push(sensor.desc);
    }
    socket.send(JSON.stringify({ command, data }));
}
let logTimer;
function log(sensorData) {
    for (const sensor of sensorData) {
        const log = document.getElementById(sensorId(sensor.desc) + '-value');
        if (log) {
            const date = new Date(sensor.samples[0].date);
            const value = sensor.samples[0].value;
            log.innerHTML = value + ' °C';
        }
        const desc = document.getElementById(sensorId(sensor.desc));
        if (desc) {
            const date = new Date(sensor.samples[0].date);
            const value = sensor.samples[0].value;
            desc.innerHTML = 'by ' + sensorName(sensor.desc) + ': ' +
                date.toLocaleDateString() + ', ' + date.toLocaleTimeString() + '. model: ' + sensor.attr.model;
        }
        clearTimeout(logTimer);
        logTimer = setInterval(clearSensorValue, 3000);
    }
}
class HTMLSetting {
    constructor(setting) {
        this.name = setting.name;
        this.label = setting.label;
        this.value = setting.value;
        this.defaultValue = setting.defaultValue;
        this.text = setting.text;
        this.readonly = setting.readonly;
        this.input = document.getElementById(name + 'value');
        this.backstore = this.value.toString();
        this.editBtn = document.getElementById(name + 'edit');
        this.SaveBtn = document.getElementById(name + 'save');
    }
    static create(setting) {
        if (!HTMLSetting.has(setting.name)) {
            const newSetting = new HTMLSetting(setting);
            HTMLSetting.settings.push(newSetting);
            return newSetting;
        }
        else {
            console.error('HTMLSetting.create: setting exists ', setting.name);
            throw Error();
        }
    }
    static find(name) {
        for (const setting of HTMLSetting.settings) {
            if (setting.name === name) {
                return setting;
            }
        }
        console.error('Setting.find: setting "%s" not found', name);
        console.log('HTMLSetting.get: length=', HTMLSetting.settings.length);
        throw Error();
    }
    static has(name) {
        for (const setting of HTMLSetting.settings) {
            if (setting.name === name) {
                return true;
            }
        }
        return false;
    }
    editSetting() {
        this.backstore = this.input.value;
        this.input.readOnly = true;
        this.input.classList.remove('settingReadonly');
        this.input.classList.add('settingEdit');
        this.editBtn.innerHTML = 'Avbryt';
        this.editBtn.classList.remove('settingReadonly');
        this.editBtn.classList.add('settingEdit');
        this.SaveBtn.setAttribute('style', 'display:block');
    }
    readonlySetting() {
        this.input.value = this.backstore;
        this.input.readOnly = false;
        this.input.classList.remove('settingEdit');
        this.input.classList.add('settingReadonly');
        this.editBtn.innerHTML = 'Ändra';
        this.editBtn.classList.remove('settingEdit');
        this.editBtn.classList.add('settingReadonly');
        this.SaveBtn.setAttribute('style', 'display:none');
    }
    saveSetting() {
        if (this.backstore !== this.input.value) {
            this.backstore = this.input.value;
        }
        this.readonlySetting();
    }
}
HTMLSetting.settings = [];
function addSetting(setting, section) {
    console.log('addSetting: ' + setting.name);
    // Get the contents of the template
    const template = document.getElementById('template-setting');
    if (!template) {
        console.error('addSetting: template missing');
        return;
    }
    const templateHtml = template.innerHTML;
    // replace placeholder tags
    // with actual data, and generate final HTML
    const html = templateHtml.replace(/{{name}}/g, setting.name)
        .replace(/{{label}}/g, setting.label)
        .replace(/{{text}}/g, setting.text)
        .replace(/{{value}}/g, setting.value.toString());
    const article = document.createElement('article');
    article.innerHTML = html;
    section.appendChild(article);
    const editBtn = document.getElementById(setting.name + 'edit');
    const saveBtn = document.getElementById(setting.name + 'save');
    if (setting.readonly) {
        editBtn.style.display = 'none';
        saveBtn.style.display = 'none';
    }
    else {
        on('click', editBtn, () => {
            clickedEdit(setting.name);
        });
        on('click', saveBtn, () => {
            clickedSaved(setting.name);
        });
    }
    const settingDOM = HTMLSetting.create(setting);
}
function updateSetting(setting) {
    console.log('updateSetting: ' + setting.name);
    const input = document.getElementById(setting.name + 'value');
    const readonly = input.readOnly;
    input.readOnly = false;
    input.value = setting.value.toString();
    input.readOnly = readonly;
}
function editSetting(name) {
    const input = document.getElementById(name + 'value');
    const editBtn = document.getElementById(name + 'edit');
    const SaveBtn = document.getElementById(name + 'save');
    input.readOnly = false;
    input.classList.remove('settingReadonly');
    input.classList.add('settingEdit');
    editBtn.innerHTML = 'Cancel';
    SaveBtn.setAttribute('style', 'display:block');
}
function clickedEdit(name) {
    const setting = HTMLSetting.find(name);
    const input = document.getElementById(name + 'value');
    if (input.readOnly) {
        console.log('edit:', name);
        editSetting(name);
    }
    else {
        console.log('cancel:', name);
        readonlySetting(name);
    }
}
function clickedSaved(name) {
    console.log('clickedSaved:');
    const input = document.getElementById(name + 'value');
    const SaveBtn = document.getElementById(name + 'save');
    const setting = HTMLSetting.find(name);
    if (!input || !setting || !SaveBtn) {
        console.error('clickedSaved: could not find all HTML element');
        return;
    }
    setting.backstore = input.value;
    setting.value = input.value;
    SaveBtn.setAttribute('style', 'display:none');
    readonlySetting(name);
    socket.send(JSON.stringify({ command: 'saveSetting', data: setting }));
}
function readonlySetting(name) {
    const input = document.getElementById(name + 'value');
    const editBtn = document.getElementById(name + 'edit');
    const SaveBtn = document.getElementById(name + 'save');
    const setting = HTMLSetting.find(name);
    input.classList.remove('settingEdit');
    input.classList.add('settingReadonly');
    editBtn.innerHTML = 'Edit';
    editBtn.blur();
    input.value = setting.backstore;
    input.readOnly = true;
    SaveBtn.setAttribute('style', 'display:none');
}
function receiveSettings(allSettings) {
    const section = document.getElementById('settingsSection');
    for (const setting of allSettings) {
        if (HTMLSetting.has(setting.name)) {
            updateSetting(setting);
        }
        else {
            addSetting(setting, section);
        }
    }
}
function setConnectionStatus(connected) {
    const status = document.getElementById('connection');
    isMonitoring = connected && isMonitoring;
    setMonitoringButton();
    if (status && connected && isMonitoring) {
        status.innerHTML = ' (live)';
    }
    else if (status && connected) {
        status.innerHTML = ' (Connected)';
    }
    else if (status) {
        status.innerHTML = ' (Disconnected)';
    }
}
function monitor() {
    if (isMonitoring) {
        stopMonitor(sensors);
    }
    else {
        startMonitor(sensors);
    }
}
function clearSensorValue() {
    for (const sensor of sensors) {
        const sampleDate = sensor.samples[0].date;
        if (Date.now() - sampleDate > 60000) {
            const sensorValue = document.getElementById(sensorId(sensor.desc));
            if (sensorValue) {
                sensorValue.innerHTML = 'No sensor data received last 60 seconds';
            }
        }
    }
    setConnectionStatus(socket.readyState === socket.OPEN);
    if (socket.readyState === socket.CLOSED) {
        socket = new WebSocket(url);
    }
}
function round(value, precision) {
    //    precision || (precision = 1);
    const inverse = 1.0 / precision;
    return Math.round(value * inverse) / inverse;
}
},{}]},{},[1])
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJzcmMvYnJvd3Nlci9jbGllbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUNFQSxJQUFJLEVBQUUsQ0FBQztBQUVQLFNBQVMsSUFBSTtJQUNULFFBQVEsRUFBRSxDQUFDO0lBQ1gsV0FBVyxDQUFDLGVBQWUsQ0FBQyxDQUFDO0lBQzdCLE1BQU0sVUFBVSxHQUFHLFFBQVEsQ0FBQyxjQUFjLENBQUMsU0FBUyxDQUFDLENBQUM7SUFDdEQsRUFBRSxDQUFDLE9BQU8sRUFBRSxVQUFVLEVBQUcsR0FBRSxFQUFFLEdBQUcsT0FBTyxFQUFFLENBQUMsQ0FBQSxDQUFDLENBQUMsQ0FBQztBQUNqRCxDQUFDO0FBRUQsU0FBUyxRQUFRO0lBQ2IsTUFBTSxJQUFJLEdBQUcsUUFBUSxDQUFDLGNBQWMsQ0FBQyxNQUFNLENBQUMsQ0FBQztJQUM3QyxPQUFPLENBQUMsR0FBRyxDQUFDLFlBQVksQ0FBQyxDQUFDO0lBQzFCLElBQUksQ0FBQyxXQUFXLENBQUMsUUFBUSxDQUFDLFNBQVMsRUFBQyxlQUFlLENBQUMsQ0FBQyxDQUFDO0lBQ3RELElBQUksQ0FBQyxXQUFXLENBQUMsUUFBUSxDQUFDLFVBQVUsRUFBQyxpQkFBaUIsQ0FBQyxDQUFDLENBQUM7QUFDN0QsQ0FBQztBQUVELFNBQVMsUUFBUSxDQUFDLElBQVksRUFBRSxTQUFpQjtJQUM3QyxPQUFPLENBQUMsR0FBRyxDQUFDLGlDQUFpQyxFQUFFLElBQUksRUFBRSxTQUFTLENBQUMsQ0FBQztJQUNoRSxNQUFNLEVBQUUsR0FBRyxRQUFRLENBQUMsYUFBYSxDQUFDLElBQUksQ0FBQyxDQUFDO0lBQ3hDLE1BQU0sQ0FBQyxHQUFHLFFBQVEsQ0FBQyxhQUFhLENBQUMsR0FBRyxDQUFDLENBQUM7SUFDdEMsQ0FBQyxDQUFDLFNBQVMsR0FBRyxJQUFJLENBQUM7SUFDbkIsRUFBRSxDQUFDLE9BQU8sRUFBRSxDQUFDLEVBQUUsR0FBRSxF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LEVBQUU7UUFDckMsTUFBTSxHQUFHLElBQUksU0FBUyxDQUFDLEdBQUcsQ0FBQyxDQUFDO0tBQy9CO0FBQ0wsQ0FBQztBQUVELFNBQVMsS0FBSyxDQUFDLEtBQWEsRUFBRSxTQUFpQjtJQUMzQyxtQ0FBbUM7SUFDbkMsTUFBTSxPQUFPLEdBQUcsR0FBRyxHQUFHLFNBQVMsQ0FBQztJQUNoQyxPQUFPLElBQUksQ0FBQyxLQUFLLENBQUMsS0FBSyxHQUFHLE9BQU8sQ0FBQyxHQUFHLE9BQU8sQ0FBQztBQUNqRCxDQUFDIiwiZmlsZSI6ImdlbmVyYXRlZC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24oKXtmdW5jdGlvbiByKGUsbix0KXtmdW5jdGlvbiBvKGksZil7aWYoIW5baV0pe2lmKCFlW2ldKXt2YXIgYz1cImZ1bmN0aW9uXCI9PXR5cGVvZiByZXF1aXJlJiZyZXF1aXJlO2lmKCFmJiZjKXJldHVybiBjKGksITApO2lmKHUpcmV0dXJuIHUoaSwhMCk7dmFyIGE9bmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIitpK1wiJ1wiKTt0aHJvdyBhLmNvZGU9XCJNT0RVTEVfTk9UX0ZPVU5EXCIsYX12YXIgcD1uW2ldPXtleHBvcnRzOnt9fTtlW2ldWzBdLmNhbGwocC5leHBvcnRzLGZ1bmN0aW9uKHIpe3ZhciBuPWVbaV1bMV1bcl07cmV0dXJuIG8obnx8cil9LHAscC5leHBvcnRzLHIsZSxuLHQpfXJldHVybiBuW2ldLmV4cG9ydHN9Zm9yKHZhciB1PVwiZnVuY3Rpb25cIj09dHlwZW9mIHJlcXVpcmUmJnJlcXVpcmUsaT0wO2k8dC5sZW5ndGg7aSsrKW8odFtpXSk7cmV0dXJuIG99cmV0dXJuIHJ9KSgpIiwiaW1wb3J0IHtTZW5zb3JBdHRyaWJ1dGVzfSBmcm9tICcuLy4uL21vZGVscy9zZW5zb3ItYXR0cmlidXRlcyc7XHJcblxyXG5pbml0KCk7XHJcblxyXG5mdW5jdGlvbiBpbml0KCkge1xyXG4gICAgaW5pdE1lbnUoKTtcclxuICAgIG9wZW5TZWN0aW9uKCdzZW5zb3JTZWN0aW9uJyk7XHJcbiAgICBjb25zdCBtb25pdG9yQnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21vbml0b3InKTtcclxuICAgIG9uKCdjbGljaycsIG1vbml0b3JCdG4sICAoKT0+IHsgbW9uaXRvcigpO30pO1xyXG59XHJcblxyXG5mdW5jdGlvbiBpbml0TWVudSgpIHtcclxuICAgIGNvbnN0IG1lbnUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWVudScpO1xyXG4gICAgY29uc29sZS5sb2coJ2luaXRNZW51KCknKTtcclxuICAgIG1lbnUuYXBwZW5kQ2hpbGQobWVudUl0ZW0oJ1NlbnNvcnMnLCdzZW5zb3JTZWN0aW9uJykpO1xyXG4gICAgbWVudS5hcHBlbmRDaGlsZChtZW51SXRlbSgnU2V0dGluZ3MnLCdzZXR0aW5nc1NlY3Rpb24nKSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIG1lbnVJdGVtKG5hbWU6IHN0cmluZywgc2VjdGlvbklkOiBzdHJpbmcpOiBIVE1MRWxlbWVudCB7XHJcbiAgICBjb25zb2xlLmxvZygnbWVudUl0ZW06IG5hbWU9JXMsIHNlY3Rpb25JZD0lcycsIG5hbWUsIHNlY3Rpb25JZCk7XHJcbiAgICBjb25zdCBsaSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2xpJyk7XHJcbiAgICBjb25zdCBhID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYScpO1xyXG4gICAgYS5pbm5lckhUTUwgPSBuYW1lO1xyXG4gICAgb24oJ2NsaWNrJywgYSwgKCk9PiB7IG9wZW5TZWN0aW9uKHNlY3Rpb25JZCk7fSk7XHJcblxyXG4gICAgbGkuYXBwZW5kQ2hpbGQoYSk7XHJcbiAgICByZXR1cm4gbGk7XHJcbn1cclxuXHJcblxyXG5mdW5jdGlvbiBvbihldmVudDogc3RyaW5nLCBlbGVtZW50OiBIVE1MRWxlbWVudCB8IG51bGwsIGZuOiAoKSA9PiB2b2lkKSB7XHJcbiAgICBpZiAoZWxlbWVudCkge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKCdvbiAlczogYWRkIGV2ZW50IGxpc3RlbmVyJywgZXZlbnQpO1xyXG4gICAgICAgIGVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihldmVudCwgZm4pO1xyXG4gICAgfVxyXG59XHJcblxyXG5mdW5jdGlvbiBvcGVuU2VjdGlvbihpZDogc3RyaW5nKSB7XHJcbiAgICBjb25zb2xlLmxvZygnb3BlblNlY3Rpb246ICcsIGlkKTtcclxuICAgIGNsb3NlQWN0aXZlU2VjdGlvbnMoKTtcclxuICAgIGNvbnN0IHNlY3Rpb24gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChpZCk7XHJcbiAgICBpZiAoc2VjdGlvbikge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKCdvcGVuU2VjdGlvbjogJXMnLCBpZCk7XHJcbiAgICAgICAgc2VjdGlvbi5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJztcclxuICAgICAgICBzZWN0aW9uLmNsYXNzTGlzdC5hZGQoJ2FjdGl2ZScpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICBjb25zb2xlLmxvZygnb3BlblNlY3Rpb246IHNlY3Rpb24gJXMgbm90IGZvdW5kJywgaWQpO1xyXG4gICAgfVxyXG5cclxufVxyXG5cclxuZnVuY3Rpb24gY2xvc2VBY3RpdmVTZWN0aW9ucygpIHtcclxuICAgIGNvbnN0IGFjdGl2ZUl0ZW1zID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgnYWN0aXZlJyk7XHJcblxyXG4gICAgZm9yIChsZXQgaW5kZXggPSAwOyBpbmRleCA8IGFjdGl2ZUl0ZW1zLmxlbmd0aDsgaW5kZXgrKykge1xyXG4gICAgICAgIGNvbnN0IHNlY3Rpb24gPSBhY3RpdmVJdGVtc1tpbmRleF07XHJcbiAgICAgICAgc2VjdGlvbi5jbGFzc0xpc3QucmVtb3ZlKCdhY3RpdmUnKTtcclxuICAgICAgICBzZWN0aW9uLnNldEF0dHJpYnV0ZSgnc3R5bGUnLCAnZGlzcGxheTpub25lJyk7XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgU2Vuc29yRGVzY3JpcHRpb24ge1xyXG4gICAgU046IHN0cmluZztcclxuICAgIHBvcnQ6IG51bWJlcjtcclxufVxyXG5leHBvcnQgaW50ZXJmYWNlIFNlbnNvclNhbXBsZSB7XHJcbiAgICB2YWx1ZTogbnVtYmVyO1xyXG4gICAgZGF0ZTogbnVtYmVyO1xyXG59XHJcbmV4cG9ydCBpbnRlcmZhY2UgU2Vuc29yTG9nIHtcclxuICAgIGRlc2M6IFNlbnNvckRlc2NyaXB0aW9uO1xyXG4gICAgYXR0cjogU2Vuc29yQXR0cmlidXRlcztcclxuICAgIHNhbXBsZXM6IFNlbnNvclNhbXBsZVtdO1xyXG59XHJcbmV4cG9ydCB0eXBlIFNldHRpbmdWYWx1ZSA9IHN0cmluZyB8IG51bWJlcjtcclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgU2V0dGluZyB7XHJcbiAgICBuYW1lOiBzdHJpbmc7XHJcbiAgICBsYWJlbDogc3RyaW5nO1xyXG4gICAgdmFsdWU6IFNldHRpbmdWYWx1ZTtcclxuICAgIGRlZmF1bHRWYWx1ZTogU2V0dGluZ1ZhbHVlO1xyXG4gICAgdGV4dDogc3RyaW5nO1xyXG4gICAgcmVhZG9ubHk6IGJvb2xlYW47XHJcbn1cclxuXHJcbmNvbnN0IHNlbnNvcnM6IFNlbnNvckxvZ1tdID0gW107XHJcbi8vIGxldCBzZXR0aW5ncyA9IFtdO1xyXG5cclxuY29uc3QgdXJsID0gJ3dzOi8vJyArIGRvY3VtZW50LmRvbWFpbjtcclxubGV0IHNvY2tldCA9IG5ldyBXZWJTb2NrZXQodXJsKTtcclxuc29ja2V0Lm9ub3BlbiA9IGZ1bmN0aW9uKCkge1xyXG4gICAgc2V0Q29ubmVjdGlvblN0YXR1cyh0cnVlKTtcclxuICAgIHNvY2tldC5zZW5kKEpTT04uc3RyaW5naWZ5KHtjb21tYW5kOiAnZ2V0U2Vuc29ycyd9KSk7XHJcbiAgICBzb2NrZXQuc2VuZChKU09OLnN0cmluZ2lmeSh7Y29tbWFuZDogJ2dldFNldHRpbmdzJ30pKTtcclxufTtcclxuXHJcbnNvY2tldC5vbm1lc3NhZ2UgPSBmdW5jdGlvbihldmVudCkge1xyXG4gICAgc2V0Q29ubmVjdGlvblN0YXR1cyh0cnVlKTtcclxuICAgIGNvbnN0IG1zZyA9IEpTT04ucGFyc2UoZXZlbnQuZGF0YSk7XHJcbiAgICBzd2l0Y2gobXNnLmNvbW1hbmQpIHtcclxuICAgICAgICBjYXNlICdzZW5zb3JzJzpcclxuICAgICAgICAgICAgcmVjZWl2ZVNlbnNvcnMobXNnLmRhdGEpO1xyXG4gICAgICAgICAgICBpZiAoIWlzTW9uaXRvcmluZykge1xyXG4gICAgICAgICAgICAgICAgc3RhcnRNb25pdG9yKHNlbnNvcnMpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIGNhc2UgJ3NldHRpbmdzJzpcclxuICAgICAgICAgICAgcmVjZWl2ZVNldHRpbmdzKG1zZy5kYXRhKTtcclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgY2FzZSAnbG9nJzpcclxuICAgICAgICAgICAgbG9nKG1zZy5kYXRhKTtcclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgIH1cclxufTtcclxuXHJcbnNvY2tldC5vbmNsb3NlID0gZnVuY3Rpb24oKSB7XHJcbiAgICBzZXRDb25uZWN0aW9uU3RhdHVzKGZhbHNlKTtcclxuICAgIGNsZWFyVGltZW91dChsb2dUaW1lcik7XHJcbiAgICBsb2dUaW1lciA9IHNldEludGVydmFsKGNsZWFyU2Vuc29yVmFsdWUsIDUwMDApO1xyXG59O1xyXG5cclxuc29ja2V0Lm9uZXJyb3IgPSBmdW5jdGlvbigpIHtcclxuICAgIHNldENvbm5lY3Rpb25TdGF0dXMoZmFsc2UpO1xyXG4gICAgY2xlYXJUaW1lb3V0KGxvZ1RpbWVyKTtcclxuICAgIGxvZ1RpbWVyID0gc2V0SW50ZXJ2YWwoY2xlYXJTZW5zb3JWYWx1ZSwgNTAwMCk7XHJcbn07XHJcblxyXG5cclxuXHJcbmZ1bmN0aW9uIHNlbnNvck5hbWUoZGVzYzogU2Vuc29yRGVzY3JpcHRpb24pOiBzdHJpbmcge1xyXG4gICAgcmV0dXJuIGRlc2MuU04gKyAnLCBwb3J0ICcgKyBkZXNjLnBvcnQ7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHNlbnNvcklkKGRlc2M6IFNlbnNvckRlc2NyaXB0aW9uKTogc3RyaW5nIHtcclxuICAgIGNvbnN0IHNuID0gZGVzYy5TTi5yZXBsYWNlKCcgJywgZGVzYy5TTik7XHJcbiAgICBjb25zdCBpZCA9IGRlc2MuU04ucmVwbGFjZSgnICcsIGRlc2MuU04pICsgJy0nICsgZGVzYy5wb3J0O1xyXG4gICAgcmV0dXJuIGlkO1xyXG59XHJcblxyXG5mdW5jdGlvbiByZWNlaXZlU2Vuc29ycyhzZW5zb3JzOiBTZW5zb3JMb2dbXSkge1xyXG4gICAgY29uc3Qgc2VjdGlvbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzZW5zb3JTZWN0aW9uJyk7XHJcbiAgICBmb3IgKGNvbnN0IHNlbnNvciBvZiBzZW5zb3JzKSB7XHJcbiAgICAgICAgY29uc3QgYXJ0aWNsZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2FydGljbGUnKTtcclxuICAgICAgICBjb25zdCBoZWFkaW5nID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaDMnKTtcclxuXHJcbiAgICAgICAgaGVhZGluZy5pZCA9IHNlbnNvcklkKHNlbnNvci5kZXNjKSArICctdmFsdWUnO1xyXG4gICAgICAgIGFydGljbGUuYXBwZW5kQ2hpbGQoaGVhZGluZyk7XHJcblxyXG4gICAgICAgIGNvbnN0IGRlc2MgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdwJyk7XHJcbiAgICAgICAgZGVzYy5pZCA9IHNlbnNvcklkKHNlbnNvci5kZXNjKTtcclxuICAgICAgICBhcnRpY2xlLmFwcGVuZENoaWxkKGRlc2MpO1xyXG4gICAgICAgIGlmIChzZWN0aW9uKSB7XHJcbiAgICAgICAgICAgIHNlY3Rpb24uYXBwZW5kQ2hpbGQoYXJ0aWNsZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgbG9nKHNlbnNvcnMpO1xyXG59XHJcbmxldCBpc01vbml0b3JpbmcgPSBmYWxzZTtcclxuZnVuY3Rpb24gc2V0TW9uaXRvcmluZ0J1dHRvbigpIHtcclxuICAgIGNvbnN0IGJ1dHRvbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtb25pdG9yJyk7XHJcbiAgICBpZiAoIWJ1dHRvbikgeyByZXR1cm47IH1cclxuICAgIGlmIChpc01vbml0b3JpbmcpIHtcclxuICAgICAgICBidXR0b24uaW5uZXJIVE1MID0gJ1N0b3AgbW9uaXRvcic7XHJcbiAgICAgICAgYnV0dG9uLmNsYXNzTGlzdC5hZGQoJ2lzTW9uaXRvcmluZycpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICBidXR0b24uaW5uZXJIVE1MID0gJ1N0YXJ0IE1vbml0b3InO1xyXG4gICAgICAgIGJ1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKCdpc01vbml0b3JpbmcnKTtcclxuICAgIH1cclxufVxyXG5cclxuZnVuY3Rpb24gc3RhcnRNb25pdG9yKHNlbnNvcnM6IFNlbnNvckxvZ1tdKSB7XHJcbiAgICBpc01vbml0b3JpbmcgPSB0cnVlO1xyXG4gICAgc2V0TW9uaXRvcmluZ0J1dHRvbigpO1xyXG4gICAgY29uc3QgY29tbWFuZCA9ICdzdGFydE1vbml0b3InO1xyXG4gICAgY29uc3QgZGF0YTogYW55ID0gW107XHJcbiAgICBmb3IgKGNvbnN0IHNlbnNvciBvZiBzZW5zb3JzKSB7XHJcbiAgICAgICAgZGF0YS5wdXNoKHNlbnNvci5kZXNjKTtcclxuICAgIH1cclxuICAgIHNvY2tldC5zZW5kKEpTT04uc3RyaW5naWZ5KHtjb21tYW5kLCBkYXRhfSkpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBzdG9wTW9uaXRvcihzZW5zb3JzOiBTZW5zb3JMb2dbXSkge1xyXG4gICAgaXNNb25pdG9yaW5nID0gZmFsc2U7XHJcbiAgICBzZXRNb25pdG9yaW5nQnV0dG9uKCk7XHJcbiAgICBjb25zdCBjb21tYW5kID0gJ3N0b3BNb25pdG9yJztcclxuICAgIGNvbnN0IGRhdGE6IGFueSA9IFtdO1xyXG4gICAgZm9yIChjb25zdCBzZW5zb3Igb2Ygc2Vuc29ycykge1xyXG4gICAgICAgIGRhdGEucHVzaChzZW5zb3IuZGVzYyk7XHJcbiAgICB9XHJcbiAgICBzb2NrZXQuc2VuZChKU09OLnN0cmluZ2lmeSh7Y29tbWFuZCwgZGF0YX0pKTtcclxufVxyXG5sZXQgbG9nVGltZXI6IGFueTtcclxuZnVuY3Rpb24gbG9nKHNlbnNvckRhdGE6IFNlbnNvckxvZ1tdKSB7XHJcbiAgICBmb3IgKGNvbnN0IHNlbnNvciBvZiBzZW5zb3JEYXRhKSB7XHJcbiAgICAgICAgY29uc3QgbG9nID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoc2Vuc29ySWQoc2Vuc29yLmRlc2MpICsgJy12YWx1ZScpO1xyXG4gICAgICAgIGlmIChsb2cpIHtcclxuICAgICAgICAgICAgY29uc3QgZGF0ZSA9IG5ldyBEYXRlKHNlbnNvci5zYW1wbGVzWzBdLmRhdGUpO1xyXG4gICAgICAgICAgICBjb25zdCB2YWx1ZSA9IHNlbnNvci5zYW1wbGVzWzBdLnZhbHVlO1xyXG4gICAgICAgICAgICBsb2cuaW5uZXJIVE1MID0gdmFsdWUgKyAnIMKwQyc7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnN0IGRlc2MgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChzZW5zb3JJZChzZW5zb3IuZGVzYykpO1xyXG4gICAgICAgIGlmIChkZXNjKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGRhdGUgPSBuZXcgRGF0ZShzZW5zb3Iuc2FtcGxlc1swXS5kYXRlKTtcclxuICAgICAgICAgICAgY29uc3QgdmFsdWUgPSBzZW5zb3Iuc2FtcGxlc1swXS52YWx1ZTtcclxuICAgICAgICAgICAgZGVzYy5pbm5lckhUTUwgPSAnYnkgJyArIHNlbnNvck5hbWUoc2Vuc29yLmRlc2MpICArICc6ICcgK1xyXG4gICAgICAgICAgICAgICAgZGF0ZS50b0xvY2FsZURhdGVTdHJpbmcoKSArICcsICcgKyBkYXRlLnRvTG9jYWxlVGltZVN0cmluZygpICsgJy4gbW9kZWw6ICcgKyBzZW5zb3IuYXR0ci5tb2RlbDtcclxuICAgICAgICB9XHJcbiAgICAgICAgY2xlYXJUaW1lb3V0KGxvZ1RpbWVyKTtcclxuICAgICAgICBsb2dUaW1lciA9IHNldEludGVydmFsKGNsZWFyU2Vuc29yVmFsdWUsIDMwMDApO1xyXG4gICAgfVxyXG59XHJcbmNsYXNzIEhUTUxTZXR0aW5nIGltcGxlbWVudHMgU2V0dGluZyB7XHJcbiAgICBwcml2YXRlIHN0YXRpYyBzZXR0aW5nczogSFRNTFNldHRpbmdbXSA9IFtdO1xyXG4gICAgcHVibGljIHZhbHVlOiBTZXR0aW5nVmFsdWU7XHJcbiAgICBwdWJsaWMgbGFiZWw6IHN0cmluZztcclxuICAgIHB1YmxpYyBkZWZhdWx0VmFsdWU6IFNldHRpbmdWYWx1ZTtcclxuICAgIHB1YmxpYyB0ZXh0OiBzdHJpbmc7XHJcbiAgICBwdWJsaWMgcmVhZG9ubHk6IGJvb2xlYW47XHJcbiAgICBwdWJsaWMgbmFtZTogc3RyaW5nO1xyXG4gICAgcHVibGljIGJhY2tzdG9yZTogc3RyaW5nO1xyXG4gICAgcHVibGljIGlucHV0OiBIVE1MSW5wdXRFbGVtZW50O1xyXG4gICAgcHVibGljIGVkaXRCdG46IEhUTUxCdXR0b25FbGVtZW50O1xyXG4gICAgcHVibGljIFNhdmVCdG46IEhUTUxCdXR0b25FbGVtZW50O1xyXG4gICAgY29uc3RydWN0b3Ioc2V0dGluZzogU2V0dGluZykge1xyXG4gICAgICAgIHRoaXMubmFtZSA9IHNldHRpbmcubmFtZTtcclxuICAgICAgICB0aGlzLmxhYmVsID0gc2V0dGluZy5sYWJlbDtcclxuICAgICAgICB0aGlzLnZhbHVlID0gc2V0dGluZy52YWx1ZTtcclxuICAgICAgICB0aGlzLmRlZmF1bHRWYWx1ZSA9IHNldHRpbmcuZGVmYXVsdFZhbHVlO1xyXG4gICAgICAgIHRoaXMudGV4dCA9IHNldHRpbmcudGV4dDtcclxuICAgICAgICB0aGlzLnJlYWRvbmx5ID0gc2V0dGluZy5yZWFkb25seTtcclxuICAgICAgICB0aGlzLmlucHV0ID0gPEhUTUxJbnB1dEVsZW1lbnQ+ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQobmFtZSArJ3ZhbHVlJyk7XHJcbiAgICAgICAgdGhpcy5iYWNrc3RvcmUgPSB0aGlzLnZhbHVlLnRvU3RyaW5nKCk7XHJcbiAgICAgICAgdGhpcy5lZGl0QnRuID0gPEhUTUxCdXR0b25FbGVtZW50PmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKG5hbWUgKydlZGl0Jyk7XHJcbiAgICAgICAgdGhpcy5TYXZlQnRuID0gPEhUTUxCdXR0b25FbGVtZW50PmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKG5hbWUgKydzYXZlJyk7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIHN0YXRpYyBjcmVhdGUoc2V0dGluZzogU2V0dGluZyk6IEhUTUxTZXR0aW5nIHtcclxuICAgICAgICBpZiAoIUhUTUxTZXR0aW5nLmhhcyAoc2V0dGluZy5uYW1lKSkge1xyXG4gICAgICAgICAgICBjb25zdCBuZXdTZXR0aW5nID0gbmV3IEhUTUxTZXR0aW5nKHNldHRpbmcpO1xyXG4gICAgICAgICAgICBIVE1MU2V0dGluZy5zZXR0aW5ncy5wdXNoKG5ld1NldHRpbmcpO1xyXG4gICAgICAgICAgICByZXR1cm4gbmV3U2V0dGluZztcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKCdIVE1MU2V0dGluZy5jcmVhdGU6IHNldHRpbmcgZXhpc3RzICcsIHNldHRpbmcubmFtZSk7XHJcbiAgICAgICAgICAgIHRocm93IEVycm9yKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgcHVibGljIHN0YXRpYyBmaW5kKG5hbWU6IHN0cmluZyk6IEhUTUxTZXR0aW5nIHtcclxuICAgICAgICBmb3IgKGNvbnN0IHNldHRpbmcgb2YgSFRNTFNldHRpbmcuc2V0dGluZ3MpIHtcclxuICAgICAgICAgICAgaWYgKHNldHRpbmcubmFtZSA9PT0gbmFtZSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHNldHRpbmc7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignU2V0dGluZy5maW5kOiBzZXR0aW5nIFwiJXNcIiBub3QgZm91bmQnLCBuYW1lKTtcclxuICAgICAgICBjb25zb2xlLmxvZygnSFRNTFNldHRpbmcuZ2V0OiBsZW5ndGg9JywgSFRNTFNldHRpbmcuc2V0dGluZ3MubGVuZ3RoKTtcclxuICAgICAgICB0aHJvdyBFcnJvcigpO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBzdGF0aWMgaGFzKG5hbWU6IHN0cmluZyApOiBib29sZWFuIHtcclxuICAgICAgICBmb3IgKGNvbnN0IHNldHRpbmcgb2YgSFRNTFNldHRpbmcuc2V0dGluZ3MpIHtcclxuICAgICAgICAgICAgaWYgKHNldHRpbmcubmFtZSA9PT0gbmFtZSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG4gICAgcHVibGljIGVkaXRTZXR0aW5nKCkge1xyXG4gICAgICAgIHRoaXMuYmFja3N0b3JlID0gIHRoaXMuaW5wdXQudmFsdWU7XHJcbiAgICAgICAgdGhpcy5pbnB1dC5yZWFkT25seT10cnVlO1xyXG4gICAgICAgIHRoaXMuaW5wdXQuY2xhc3NMaXN0LnJlbW92ZSgnc2V0dGluZ1JlYWRvbmx5Jyk7XHJcbiAgICAgICAgdGhpcy5pbnB1dC5jbGFzc0xpc3QuYWRkKCdzZXR0aW5nRWRpdCcpO1xyXG5cclxuICAgICAgICB0aGlzLmVkaXRCdG4uaW5uZXJIVE1MPSdBdmJyeXQnO1xyXG4gICAgICAgIHRoaXMuZWRpdEJ0bi5jbGFzc0xpc3QucmVtb3ZlKCdzZXR0aW5nUmVhZG9ubHknKTtcclxuICAgICAgICB0aGlzLmVkaXRCdG4uY2xhc3NMaXN0LmFkZCgnc2V0dGluZ0VkaXQnKTtcclxuXHJcbiAgICAgICAgdGhpcy5TYXZlQnRuLnNldEF0dHJpYnV0ZSgnc3R5bGUnLCAnZGlzcGxheTpibG9jaycpO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyByZWFkb25seVNldHRpbmcoKSB7XHJcbiAgICAgICAgdGhpcy5pbnB1dC52YWx1ZT10aGlzLmJhY2tzdG9yZTtcclxuICAgICAgICB0aGlzLmlucHV0LnJlYWRPbmx5PWZhbHNlO1xyXG4gICAgICAgIHRoaXMuaW5wdXQuY2xhc3NMaXN0LnJlbW92ZSgnc2V0dGluZ0VkaXQnKTtcclxuICAgICAgICB0aGlzLmlucHV0LmNsYXNzTGlzdC5hZGQoJ3NldHRpbmdSZWFkb25seScpO1xyXG5cclxuICAgICAgICB0aGlzLmVkaXRCdG4uaW5uZXJIVE1MPSfDhG5kcmEnO1xyXG4gICAgICAgIHRoaXMuZWRpdEJ0bi5jbGFzc0xpc3QucmVtb3ZlKCdzZXR0aW5nRWRpdCcpO1xyXG4gICAgICAgIHRoaXMuZWRpdEJ0bi5jbGFzc0xpc3QuYWRkKCdzZXR0aW5nUmVhZG9ubHknKTtcclxuXHJcbiAgICAgICAgdGhpcy5TYXZlQnRuLnNldEF0dHJpYnV0ZSgnc3R5bGUnLCAnZGlzcGxheTpub25lJyk7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIHNhdmVTZXR0aW5nKCkge1xyXG4gICAgICAgIGlmICh0aGlzLmJhY2tzdG9yZSAhPT0gdGhpcy5pbnB1dC52YWx1ZSkge1xyXG4gICAgICAgICAgICB0aGlzLmJhY2tzdG9yZT10aGlzLmlucHV0LnZhbHVlO1xyXG4gICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5yZWFkb25seVNldHRpbmcoKTtcclxuICAgIH1cclxufVxyXG5cclxuXHJcbmZ1bmN0aW9uIGFkZFNldHRpbmcoc2V0dGluZzogU2V0dGluZywgc2VjdGlvbjogSFRNTEVsZW1lbnQpIHtcclxuICAgIGNvbnNvbGUubG9nKCdhZGRTZXR0aW5nOiAnICsgc2V0dGluZy5uYW1lKTtcclxuICAgIC8vIEdldCB0aGUgY29udGVudHMgb2YgdGhlIHRlbXBsYXRlXHJcbiAgICBjb25zdCB0ZW1wbGF0ZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0ZW1wbGF0ZS1zZXR0aW5nJyk7XHJcbiAgICBpZiAoIXRlbXBsYXRlKSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignYWRkU2V0dGluZzogdGVtcGxhdGUgbWlzc2luZycpO1xyXG4gICAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIGNvbnN0IHRlbXBsYXRlSHRtbCA9IHRlbXBsYXRlLmlubmVySFRNTDtcclxuXHJcbiAgICAvLyByZXBsYWNlIHBsYWNlaG9sZGVyIHRhZ3NcclxuICAgIC8vIHdpdGggYWN0dWFsIGRhdGEsIGFuZCBnZW5lcmF0ZSBmaW5hbCBIVE1MXHJcblxyXG4gICAgY29uc3QgaHRtbCA9IHRlbXBsYXRlSHRtbC5yZXBsYWNlKC97e25hbWV9fS9nLCBzZXR0aW5nLm5hbWUpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAucmVwbGFjZSgve3tsYWJlbH19L2csIHNldHRpbmcubGFiZWwpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAucmVwbGFjZSgve3t0ZXh0fX0vZywgc2V0dGluZy50ZXh0KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnJlcGxhY2UoL3t7dmFsdWV9fS9nLCBzZXR0aW5nLnZhbHVlLnRvU3RyaW5nKCkpO1xyXG5cclxuICAgIGNvbnN0IGFydGljbGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhcnRpY2xlJyk7XHJcbiAgICBhcnRpY2xlLmlubmVySFRNTCA9IGh0bWw7XHJcbiAgICBzZWN0aW9uLmFwcGVuZENoaWxkKGFydGljbGUpO1xyXG4gICAgY29uc3QgZWRpdEJ0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHNldHRpbmcubmFtZSArICdlZGl0Jyk7XHJcbiAgICBjb25zdCBzYXZlQnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoc2V0dGluZy5uYW1lICsgJ3NhdmUnKTtcclxuICAgIGlmIChzZXR0aW5nLnJlYWRvbmx5KSB7XHJcbiAgICAgICAgZWRpdEJ0bi5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xyXG4gICAgICAgIHNhdmVCdG4uc3R5bGUuZGlzcGxheSA9ICdub25lJztcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgb24gKCdjbGljaycsIGVkaXRCdG4sICgpPT4ge1xyXG4gICAgICAgICAgICBjbGlja2VkRWRpdChzZXR0aW5nLm5hbWUpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIG9uICgnY2xpY2snLCBzYXZlQnRuLCAoKT0+IHtcclxuICAgICAgICAgICAgY2xpY2tlZFNhdmVkKHNldHRpbmcubmFtZSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3Qgc2V0dGluZ0RPTTogSFRNTFNldHRpbmcgPSAgSFRNTFNldHRpbmcuY3JlYXRlKHNldHRpbmcpO1xyXG59XHJcblxyXG5mdW5jdGlvbiB1cGRhdGVTZXR0aW5nKHNldHRpbmc6IFNldHRpbmcpIHtcclxuICAgIGNvbnNvbGUubG9nKCd1cGRhdGVTZXR0aW5nOiAnICsgc2V0dGluZy5uYW1lKTtcclxuICAgIGNvbnN0IGlucHV0ID0gPEhUTUxJbnB1dEVsZW1lbnQ+ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoc2V0dGluZy5uYW1lICsndmFsdWUnKTtcclxuICAgIGNvbnN0IHJlYWRvbmx5ID0gaW5wdXQucmVhZE9ubHk7XHJcbiAgICBpbnB1dC5yZWFkT25seT1mYWxzZTtcclxuICAgIGlucHV0LnZhbHVlID0gc2V0dGluZy52YWx1ZS50b1N0cmluZygpO1xyXG4gICAgaW5wdXQucmVhZE9ubHkgPSByZWFkb25seTtcclxufVxyXG5cclxuZnVuY3Rpb24gZWRpdFNldHRpbmcobmFtZTogc3RyaW5nKSB7XHJcbiAgICBjb25zdCBpbnB1dCA9IDxIVE1MSW5wdXRFbGVtZW50PmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKG5hbWUgKyd2YWx1ZScpO1xyXG4gICAgY29uc3QgZWRpdEJ0biA9IDxIVE1MQnV0dG9uRWxlbWVudD5kb2N1bWVudC5nZXRFbGVtZW50QnlJZChuYW1lICsnZWRpdCcpO1xyXG4gICAgY29uc3QgU2F2ZUJ0biA9IDxIVE1MQnV0dG9uRWxlbWVudD5kb2N1bWVudC5nZXRFbGVtZW50QnlJZChuYW1lICsnc2F2ZScpO1xyXG4gICAgaW5wdXQucmVhZE9ubHkgPSBmYWxzZTtcclxuICAgIGlucHV0LmNsYXNzTGlzdC5yZW1vdmUoJ3NldHRpbmdSZWFkb25seScpO1xyXG4gICAgaW5wdXQuY2xhc3NMaXN0LmFkZCgnc2V0dGluZ0VkaXQnKTtcclxuXHJcbiAgICBlZGl0QnRuLmlubmVySFRNTD0nQ2FuY2VsJztcclxuXHJcbiAgICBTYXZlQnRuLnNldEF0dHJpYnV0ZSgnc3R5bGUnLCAnZGlzcGxheTpibG9jaycpO1xyXG59XHJcbmZ1bmN0aW9uIGNsaWNrZWRFZGl0KG5hbWU6IHN0cmluZykge1xyXG4gICAgY29uc3Qgc2V0dGluZyA9IEhUTUxTZXR0aW5nLmZpbmQobmFtZSk7XHJcbiAgICBjb25zdCBpbnB1dD08SFRNTElucHV0RWxlbWVudD5kb2N1bWVudC5nZXRFbGVtZW50QnlJZChuYW1lICsndmFsdWUnKTtcclxuICAgIGlmIChpbnB1dC5yZWFkT25seSkge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKCdlZGl0OicsIG5hbWUpO1xyXG4gICAgICAgIGVkaXRTZXR0aW5nKG5hbWUpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICBjb25zb2xlLmxvZygnY2FuY2VsOicsIG5hbWUpO1xyXG4gICAgICAgIHJlYWRvbmx5U2V0dGluZyhuYW1lKTtcclxuICAgIH1cclxufVxyXG5mdW5jdGlvbiBjbGlja2VkU2F2ZWQobmFtZTogc3RyaW5nKSB7XHJcbiAgICBjb25zb2xlLmxvZygnY2xpY2tlZFNhdmVkOicpO1xyXG4gICAgY29uc3QgaW5wdXQgPSA8SFRNTElucHV0RWxlbWVudD5kb2N1bWVudC5nZXRFbGVtZW50QnlJZChuYW1lICsndmFsdWUnKTtcclxuICAgIGNvbnN0IFNhdmVCdG4gPSA8SFRNTEJ1dHRvbkVsZW1lbnQ+ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQobmFtZSArJ3NhdmUnKTtcclxuICAgIGNvbnN0IHNldHRpbmc6IEhUTUxTZXR0aW5nID0gSFRNTFNldHRpbmcuZmluZChuYW1lKTtcclxuICAgIGlmICghaW5wdXQgfHwgIXNldHRpbmcgfHwgIVNhdmVCdG4pIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdjbGlja2VkU2F2ZWQ6IGNvdWxkIG5vdCBmaW5kIGFsbCBIVE1MIGVsZW1lbnQnKTtcclxuICAgICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICBzZXR0aW5nLmJhY2tzdG9yZSA9IGlucHV0LnZhbHVlO1xyXG4gICAgc2V0dGluZy52YWx1ZSA9IGlucHV0LnZhbHVlO1xyXG4gICAgU2F2ZUJ0bi5zZXRBdHRyaWJ1dGUoJ3N0eWxlJywgJ2Rpc3BsYXk6bm9uZScpO1xyXG4gICAgcmVhZG9ubHlTZXR0aW5nKG5hbWUpO1xyXG4gICAgc29ja2V0LnNlbmQoSlNPTi5zdHJpbmdpZnkoe2NvbW1hbmQ6ICdzYXZlU2V0dGluZycsIGRhdGE6IDxTZXR0aW5nPnNldHRpbmd9KSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHJlYWRvbmx5U2V0dGluZyhuYW1lOiBzdHJpbmcpIHtcclxuICAgIGNvbnN0IGlucHV0ID0gPEhUTUxJbnB1dEVsZW1lbnQ+ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQobmFtZSArJ3ZhbHVlJyk7XHJcbiAgICBjb25zdCBlZGl0QnRuID0gPEhUTUxCdXR0b25FbGVtZW50PmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKG5hbWUgKydlZGl0Jyk7XHJcbiAgICBjb25zdCBTYXZlQnRuID0gPEhUTUxCdXR0b25FbGVtZW50PmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKG5hbWUgKydzYXZlJyk7XHJcbiAgICBjb25zdCBzZXR0aW5nID0gSFRNTFNldHRpbmcuZmluZChuYW1lKTtcclxuXHJcbiAgICBpbnB1dC5jbGFzc0xpc3QucmVtb3ZlKCdzZXR0aW5nRWRpdCcpO1xyXG4gICAgaW5wdXQuY2xhc3NMaXN0LmFkZCgnc2V0dGluZ1JlYWRvbmx5Jyk7XHJcblxyXG4gICAgZWRpdEJ0bi5pbm5lckhUTUw9J0VkaXQnO1xyXG5cclxuICAgIGVkaXRCdG4uYmx1cigpO1xyXG5cclxuICAgIGlucHV0LnZhbHVlPXNldHRpbmcuYmFja3N0b3JlO1xyXG4gICAgaW5wdXQucmVhZE9ubHk9dHJ1ZTtcclxuXHJcbiAgICBTYXZlQnRuLnNldEF0dHJpYnV0ZSgnc3R5bGUnLCAnZGlzcGxheTpub25lJyk7XHJcbn1cclxuXHJcblxyXG5mdW5jdGlvbiByZWNlaXZlU2V0dGluZ3MoYWxsU2V0dGluZ3M6IFNldHRpbmdbXSkge1xyXG4gICAgY29uc3Qgc2VjdGlvbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzZXR0aW5nc1NlY3Rpb24nKTtcclxuICAgIGZvciAoY29uc3Qgc2V0dGluZyBvZiBhbGxTZXR0aW5ncykge1xyXG4gICAgICAgIGlmIChIVE1MU2V0dGluZy5oYXMoc2V0dGluZy5uYW1lKSkge1xyXG4gICAgICAgICAgICB1cGRhdGVTZXR0aW5nKHNldHRpbmcpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGFkZFNldHRpbmcoc2V0dGluZywgc2VjdGlvbik7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcbmZ1bmN0aW9uIHNldENvbm5lY3Rpb25TdGF0dXMoY29ubmVjdGVkOiBib29sZWFuKSB7XHJcbiAgICBjb25zdCBzdGF0dXMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY29ubmVjdGlvbicpO1xyXG4gICAgaXNNb25pdG9yaW5nID0gY29ubmVjdGVkICYmIGlzTW9uaXRvcmluZztcclxuICAgIHNldE1vbml0b3JpbmdCdXR0b24oKTtcclxuICAgIGlmIChzdGF0dXMgJiYgY29ubmVjdGVkICYmIGlzTW9uaXRvcmluZykge1xyXG4gICAgICAgIHN0YXR1cy5pbm5lckhUTUwgPSAnIChsaXZlKSc7XHJcbiAgICB9IGVsc2UgaWYgKHN0YXR1cyAmJiBjb25uZWN0ZWQpIHtcclxuICAgICAgICBzdGF0dXMuaW5uZXJIVE1MID0gJyAoQ29ubmVjdGVkKSc7XHJcbiAgICB9IGVsc2UgaWYgKHN0YXR1cykge1xyXG4gICAgICAgIHN0YXR1cy5pbm5lckhUTUwgPSAnIChEaXNjb25uZWN0ZWQpJztcclxuICAgIH1cclxufVxyXG5cclxuZnVuY3Rpb24gbW9uaXRvcigpIHtcclxuICAgIGlmIChpc01vbml0b3JpbmcpIHtcclxuICAgICAgICBzdG9wTW9uaXRvcihzZW5zb3JzKTtcclxuXHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgIHN0YXJ0TW9uaXRvcihzZW5zb3JzKTtcclxuICAgIH1cclxufVxyXG5cclxuZnVuY3Rpb24gY2xlYXJTZW5zb3JWYWx1ZSgpIHtcclxuICAgIGZvciAoY29uc3Qgc2Vuc29yIG9mIHNlbnNvcnMpIHtcclxuICAgICAgICBjb25zdCBzYW1wbGVEYXRlID0gc2Vuc29yLnNhbXBsZXNbMF0uZGF0ZTtcclxuICAgICAgICBpZiAoRGF0ZS5ub3coKSAtIHNhbXBsZURhdGUgPiA2MF8wMDApIHtcclxuICAgICAgICAgICAgY29uc3Qgc2Vuc29yVmFsdWUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChzZW5zb3JJZChzZW5zb3IuZGVzYykpO1xyXG4gICAgICAgICAgICBpZiAoc2Vuc29yVmFsdWUpIHtcclxuICAgICAgICAgICAgICAgIHNlbnNvclZhbHVlLmlubmVySFRNTCA9ICdObyBzZW5zb3IgZGF0YSByZWNlaXZlZCBsYXN0IDYwIHNlY29uZHMnO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHNldENvbm5lY3Rpb25TdGF0dXMoc29ja2V0LnJlYWR5U3RhdGUgPT09IHNvY2tldC5PUEVOKTtcclxuICAgIGlmIChzb2NrZXQucmVhZHlTdGF0ZSA9PT0gc29ja2V0LkNMT1NFRCkge1xyXG4gICAgICAgIHNvY2tldCA9IG5ldyBXZWJTb2NrZXQodXJsKTtcclxuICAgIH1cclxufVxyXG5cclxuZnVuY3Rpb24gcm91bmQodmFsdWU6IG51bWJlciwgcHJlY2lzaW9uOiBudW1iZXIpIHtcclxuICAgIC8vICAgIHByZWNpc2lvbiB8fCAocHJlY2lzaW9uID0gMSk7XHJcbiAgICBjb25zdCBpbnZlcnNlID0gMS4wIC8gcHJlY2lzaW9uO1xyXG4gICAgcmV0dXJuIE1hdGgucm91bmQodmFsdWUgKiBpbnZlcnNlKSAvIGludmVyc2U7XHJcbn1cclxuIl19
