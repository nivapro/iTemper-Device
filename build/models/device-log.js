"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
var axios_1 = __importDefault(require("axios"));
var logger_1 = require("../logger");
var settings_1 = require("./settings");
var DeviceLog = (function () {
    function DeviceLog(state) {
        this.retryCounter = 0;
        this.timestamp = 0;
        this.logging = false;
        this.SHARED_ACCESS_KEY = '';
        this.ITEMPER_URL = '';
        this.timestamp = Date.now();
        this.logging = false;
        this.state = state;
        this.initSettings();
        this.state.addDeviceDataListener(this.onDataReceived.bind(this));
        this.axios = this.createAxiosInstance();
    }
    DeviceLog.prototype.createAxiosInstance = function () {
        return this.axios = axios_1.default.create({
            baseURL: this.ITEMPER_URL + '/device',
            headers: { 'Content-Type': 'application/json' }
        });
    };
    DeviceLog.prototype.initSettings = function () {
        var _this = this;
        this.SHARED_ACCESS_KEY = settings_1.Settings.get(settings_1.Settings.SHARED_ACCESS_KEY).value.toString();
        this.ITEMPER_URL = settings_1.Settings.get(settings_1.Settings.ITEMPER_URL).value.toString();
        settings_1.Settings.onChange('SHARED_ACCESS_KEY', function (setting) {
            _this.SHARED_ACCESS_KEY = setting.value.toString();
            logger_1.log.debug('DeviceLog.settingChanged: SHARED_ACCESS_KEY=' + _this.SHARED_ACCESS_KEY);
        });
        settings_1.Settings.onChange('ITEMPER_URL', function (setting) {
            _this.ITEMPER_URL = setting.value.toString();
            logger_1.log.debug('DeviceLog.settingChanged: ITEMPER_URL=' + _this.ITEMPER_URL);
            _this.axios = _this.createAxiosInstance();
        });
    };
    DeviceLog.prototype.getState = function () {
        return this.state;
    };
    DeviceLog.prototype.islogging = function () {
        return this.logging;
    };
    DeviceLog.prototype.startLogging = function () {
        logger_1.log.debug('DeviceLog.startLogging');
        this.logging = true;
    };
    DeviceLog.prototype.stopLogging = function () {
        logger_1.log.debug('DeviceLog.stopLogging');
        this.logging = false;
    };
    DeviceLog.prototype.onDataReceived = function (data) {
        if (this.logging) {
            var diff_1 = data.timestamp - this.timestamp;
            this.timestamp = data.timestamp;
            var deviceLog_1 = { data: data };
            var url_1 = '/status';
            logger_1.log.debug('DeviceLog.onDataReceived, URL: ' + url_1);
            var Authorization = 'Bearer ' + this.SHARED_ACCESS_KEY;
            this.axios.post(url_1, deviceLog_1, { headers: { Authorization: Authorization } })
                .then(function (res) {
                logger_1.log.info('DeviceLog.onDataReceived, post ' + url_1 + ' ' + res.statusText +
                    ' res.data: ' + JSON.stringify(deviceLog_1) + ' ms: ' + diff_1 +
                    ' date: ' + new Date(data.timestamp.toLocaleString()));
            })
                .catch(function (error) {
                if (error.response) {
                    logger_1.log.debug('DeviceLog.onDataReceived:' + error.response.status + ' - ' +
                        JSON.stringify(error.response.data));
                }
                else if (error.request) {
                    logger_1.log.error('DeviceLog.onDataReceived, request, no response:' + error.request);
                }
                else {
                    logger_1.log.error('DeviceLog.onDataReceived,  error.config:' + error.config);
                }
            });
        }
    };
    return DeviceLog;
}());
exports.DeviceLog = DeviceLog;

//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9tb2RlbHMvZGV2aWNlLWxvZy50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7OztBQUFBLGdEQUF5RDtBQUl6RCxvQ0FBZ0M7QUFFaEMsdUNBQTZDO0FBTTdDO0lBaUJJLG1CQUFZLEtBQWtCO1FBaEJ2QixpQkFBWSxHQUFHLENBQUMsQ0FBQztRQUdoQixjQUFTLEdBQVcsQ0FBQyxDQUFDO1FBQ3RCLFlBQU8sR0FBWSxLQUFLLENBQUM7UUFHekIsc0JBQWlCLEdBQVcsRUFBRSxDQUFDO1FBQy9CLGdCQUFXLEdBQVcsRUFBRSxDQUFDO1FBUzdCLElBQUksQ0FBQyxTQUFTLEdBQUcsSUFBSSxDQUFDLEdBQUcsRUFBRSxDQUFDO1FBQzVCLElBQUksQ0FBQyxPQUFPLEdBQUcsS0FBSyxDQUFDO1FBQ3JCLElBQUksQ0FBQyxLQUFLLEdBQUcsS0FBSyxDQUFDO1FBQ25CLElBQUksQ0FBQyxZQUFZLEVBQUUsQ0FBQztRQUNwQixJQUFJLENBQUMsS0FBSyxDQUFDLHFCQUFxQixDQUFDLElBQUksQ0FBQyxjQUFjLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUM7UUFDakUsSUFBSSxDQUFDLEtBQUssR0FBRyxJQUFJLENBQUMsbUJBQW1CLEVBQUUsQ0FBQztJQUM1QyxDQUFDO0lBYk8sdUNBQW1CLEdBQTNCO1FBQ0ksT0FBTyxJQUFJLENBQUMsS0FBSyxHQUFHLGVBQUssQ0FBQyxNQUFNLENBQUM7WUFDN0IsT0FBTyxFQUFFLElBQUksQ0FBQyxXQUFXLEdBQUcsU0FBUztZQUNyQyxPQUFPLEVBQUUsRUFBQyxjQUFjLEVBQUUsa0JBQWtCLEVBQUM7U0FBQyxDQUFDLENBQUM7SUFDeEQsQ0FBQztJQVdPLGdDQUFZLEdBQXBCO1FBQUEsaUJBZ0JDO1FBZkcsSUFBSSxDQUFDLGlCQUFpQixHQUFHLG1CQUFRLENBQUMsR0FBRyxDQUFDLG1CQUFRLENBQUMsaUJBQWlCLENBQUMsQ0FBQyxLQUFLLENBQUMsUUFBUSxFQUFFLENBQUM7UUFFbkYsSUFBSSxDQUFDLFdBQVcsR0FBRyxtQkFBUSxDQUFDLEdBQUcsQ0FBQyxtQkFBUSxDQUFDLFdBQVcsQ0FBQyxDQUFDLEtBQUssQ0FBQyxRQUFRLEVBQUUsQ0FBQztRQUd2RSxtQkFBUSxDQUFDLFFBQVEsQ0FBQyxtQkFBbUIsRUFBRSxVQUFDLE9BQWdCO1lBQ3BELEtBQUksQ0FBQyxpQkFBaUIsR0FBRyxPQUFPLENBQUMsS0FBSyxDQUFDLFFBQVEsRUFBRSxDQUFDO1lBQ2xELFlBQUcsQ0FBQyxLQUFLLENBQUMsOENBQThDLEdBQUcsS0FBSSxDQUFDLGlCQUFpQixDQUFDLENBQUM7UUFDdkYsQ0FBQyxDQUFDLENBQUM7UUFFSCxtQkFBUSxDQUFDLFFBQVEsQ0FBQyxhQUFhLEVBQUUsVUFBQyxPQUFnQjtZQUM5QyxLQUFJLENBQUMsV0FBVyxHQUFHLE9BQU8sQ0FBQyxLQUFLLENBQUMsUUFBUSxFQUFFLENBQUM7WUFDNUMsWUFBRyxDQUFDLEtBQUssQ0FBQyx3Q0FBd0MsR0FBSSxLQUFJLENBQUMsV0FBVyxDQUFDLENBQUM7WUFDeEUsS0FBSSxDQUFDLEtBQUssR0FBRyxLQUFJLENBQUMsbUJBQW1CLEVBQUUsQ0FBQztRQUM1QyxDQUFDLENBQUMsQ0FBQztJQUNQLENBQUM7SUFDTSw0QkFBUSxHQUFmO1FBQ0ksT0FBTyxJQUFJLENBQUMsS0FBSyxDQUFDO0lBQ3RCLENBQUM7SUFDTSw2QkFBUyxHQUFoQjtRQUNJLE9BQU8sSUFBSSxDQUFDLE9BQU8sQ0FBQztJQUN4QixDQUFDO0lBQ00sZ0NBQVksR0FBbkI7UUFDSSxZQUFHLENBQUMsS0FBSyxDQUFDLHdCQUF3QixDQUFDLENBQUM7UUFDcEMsSUFBSSxDQUFDLE9BQU8sR0FBRyxJQUFJLENBQUM7SUFDeEIsQ0FBQztJQUVNLCtCQUFXLEdBQWxCO1FBQ0ksWUFBRyxDQUFDLEtBQUssQ0FBQyx1QkFBdUIsQ0FBQyxDQUFDO1FBQ25DLElBQUksQ0FBQyxPQUFPLEdBQUcsS0FBSyxDQUFDO0lBQ3pCLENBQUM7SUFFTyxrQ0FBYyxHQUF0QixVQUF1QixJQUFnQjtRQUNuQyxJQUFJLElBQUksQ0FBQyxPQUFPLEVBQUU7WUFFZCxJQUFNLE1BQUksR0FBRyxJQUFJLENBQUMsU0FBUyxHQUFHLElBQUksQ0FBQyxTQUFTLENBQUM7WUFDN0MsSUFBSSxDQUFDLFNBQVMsR0FBRyxJQUFJLENBQUMsU0FBUyxDQUFDO1lBQ2hDLElBQU0sV0FBUyxHQUFrQixFQUFDLElBQUksTUFBQSxFQUFDLENBQUM7WUFDeEMsSUFBTSxLQUFHLEdBQUcsU0FBUyxDQUFDO1lBQ3RCLFlBQUcsQ0FBQyxLQUFLLENBQUMsaUNBQWlDLEdBQUcsS0FBRyxDQUFDLENBQUM7WUFFbkQsSUFBTSxhQUFhLEdBQUcsU0FBUyxHQUFHLElBQUksQ0FBQyxpQkFBaUIsQ0FBQztZQUN6RCxJQUFJLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBZ0IsS0FBRyxFQUFFLFdBQVMsRUFBRSxFQUFDLE9BQU8sRUFBRSxFQUFFLGFBQWEsZUFBQSxFQUFFLEVBQUMsQ0FBQztpQkFDM0UsSUFBSSxDQUFFLFVBQVMsR0FBRztnQkFDZixZQUFHLENBQUMsSUFBSSxDQUFDLGlDQUFpQyxHQUFHLEtBQUcsR0FBRyxHQUFHLEdBQUcsR0FBRyxDQUFDLFVBQVU7b0JBQ25FLGFBQWEsR0FBRyxJQUFJLENBQUMsU0FBUyxDQUFDLFdBQVMsQ0FBQyxHQUFHLE9BQU8sR0FBRyxNQUFJO29CQUMxRCxTQUFTLEdBQUcsSUFBSSxJQUFJLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxjQUFjLEVBQUUsQ0FBQyxDQUFDLENBQUM7WUFDL0QsQ0FBQyxDQUFDO2lCQUNELEtBQUssQ0FBQyxVQUFTLEtBQWlCO2dCQUM3QixJQUFJLEtBQUssQ0FBQyxRQUFRLEVBQUU7b0JBR2hCLFlBQUcsQ0FBQyxLQUFLLENBQUMsMkJBQTJCLEdBQUksS0FBSyxDQUFDLFFBQVEsQ0FBQyxNQUFNLEdBQUcsS0FBSzt3QkFDdEUsSUFBSSxDQUFDLFNBQVMsQ0FBQyxLQUFLLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUM7aUJBQ3hDO3FCQUFNLElBQUksS0FBSyxDQUFDLE9BQU8sRUFBRTtvQkFFdEIsWUFBRyxDQUFDLEtBQUssQ0FBQyxpREFBaUQsR0FBRyxLQUFLLENBQUMsT0FBTyxDQUFDLENBQUM7aUJBQ2hGO3FCQUFNO29CQUVILFlBQUcsQ0FBQyxLQUFLLENBQUMsMENBQTBDLEdBQUcsS0FBSyxDQUFDLE1BQU0sQ0FBQyxDQUFDO2lCQUN4RTtZQUVMLENBQUMsQ0FBQyxDQUFDO1NBQ047SUFDTCxDQUFDO0lBQ0wsZ0JBQUM7QUFBRCxDQTVGQSxBQTRGQyxJQUFBO0FBNUZZLDhCQUFTIiwiZmlsZSI6Im1vZGVscy9kZXZpY2UtbG9nLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IGF4aW9zLCB7IEF4aW9zRXJyb3IsIEF4aW9zSW5zdGFuY2UgfSBmcm9tICdheGlvcyc7XHJcbmltcG9ydCB7IERldmljZURhdGEgfSBmcm9tICcuL2RldmljZS1kYXRhJztcclxuaW1wb3J0IHsgRGV2aWNlU3RhdGUgfSBmcm9tICcuL2RldmljZS1zdGF0ZSc7XHJcblxyXG5pbXBvcnQgeyBsb2cgfSBmcm9tICcuLi9sb2dnZXInO1xyXG5cclxuaW1wb3J0IHtTZXR0aW5nLCBTZXR0aW5nc30gZnJvbSAnLi9zZXR0aW5ncyc7XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIERldmljZURhdGFMb2cge1xyXG4gICAgZGF0YTogRGV2aWNlRGF0YTtcclxufVxyXG5cclxuZXhwb3J0IGNsYXNzIERldmljZUxvZyB7XHJcbiAgICBwdWJsaWMgcmV0cnlDb3VudGVyID0gMDtcclxuICAgIHByaXZhdGUgc3RhdGU6IERldmljZVN0YXRlO1xyXG5cclxuICAgIHByaXZhdGUgdGltZXN0YW1wOiBudW1iZXIgPSAwO1xyXG4gICAgcHJpdmF0ZSBsb2dnaW5nOiBib29sZWFuID0gZmFsc2U7XHJcblxyXG4gICAgcHJpdmF0ZSBheGlvczogQXhpb3NJbnN0YW5jZTtcclxuICAgIHByaXZhdGUgU0hBUkVEX0FDQ0VTU19LRVk6IHN0cmluZyA9ICcnO1xyXG4gICAgcHJpdmF0ZSBJVEVNUEVSX1VSTDogc3RyaW5nID0gJyc7XHJcblxyXG4gICAgcHJpdmF0ZSBjcmVhdGVBeGlvc0luc3RhbmNlKCk6IEF4aW9zSW5zdGFuY2Uge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmF4aW9zID0gYXhpb3MuY3JlYXRlKHtcclxuICAgICAgICAgICAgYmFzZVVSTDogdGhpcy5JVEVNUEVSX1VSTCArICcvZGV2aWNlJyxcclxuICAgICAgICAgICAgaGVhZGVyczogeydDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbid9fSk7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3RydWN0b3Ioc3RhdGU6IERldmljZVN0YXRlKSB7XHJcbiAgICAgICAgdGhpcy50aW1lc3RhbXAgPSBEYXRlLm5vdygpO1xyXG4gICAgICAgIHRoaXMubG9nZ2luZyA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuc3RhdGUgPSBzdGF0ZTtcclxuICAgICAgICB0aGlzLmluaXRTZXR0aW5ncygpO1xyXG4gICAgICAgIHRoaXMuc3RhdGUuYWRkRGV2aWNlRGF0YUxpc3RlbmVyKHRoaXMub25EYXRhUmVjZWl2ZWQuYmluZCh0aGlzKSk7XHJcbiAgICAgICAgdGhpcy5heGlvcyA9IHRoaXMuY3JlYXRlQXhpb3NJbnN0YW5jZSgpO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgaW5pdFNldHRpbmdzKCkge1xyXG4gICAgICAgIHRoaXMuU0hBUkVEX0FDQ0VTU19LRVkgPSBTZXR0aW5ncy5nZXQoU2V0dGluZ3MuU0hBUkVEX0FDQ0VTU19LRVkpLnZhbHVlLnRvU3RyaW5nKCk7XHJcblxyXG4gICAgICAgIHRoaXMuSVRFTVBFUl9VUkwgPSBTZXR0aW5ncy5nZXQoU2V0dGluZ3MuSVRFTVBFUl9VUkwpLnZhbHVlLnRvU3RyaW5nKCk7XHJcbiAgICAgICAgLy8gdGhpcy5BWlVSRV9DT05ORUNUSU9OX1NUUklORyA9IFNldHRpbmdzLmdldChTZXR0aW5ncy5BWlVSRV9DT05ORUNUSU9OX1NUUklORykudmFsdWUudG9TdHJpbmcoKTtcclxuXHJcbiAgICAgICAgU2V0dGluZ3Mub25DaGFuZ2UoJ1NIQVJFRF9BQ0NFU1NfS0VZJywgKHNldHRpbmc6IFNldHRpbmcpID0+IHtcclxuICAgICAgICAgICAgdGhpcy5TSEFSRURfQUNDRVNTX0tFWSA9IHNldHRpbmcudmFsdWUudG9TdHJpbmcoKTtcclxuICAgICAgICAgICAgbG9nLmRlYnVnKCdEZXZpY2VMb2cuc2V0dGluZ0NoYW5nZWQ6IFNIQVJFRF9BQ0NFU1NfS0VZPScgKyB0aGlzLlNIQVJFRF9BQ0NFU1NfS0VZKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgU2V0dGluZ3Mub25DaGFuZ2UoJ0lURU1QRVJfVVJMJywgKHNldHRpbmc6IFNldHRpbmcpPT4ge1xyXG4gICAgICAgICAgICB0aGlzLklURU1QRVJfVVJMID0gc2V0dGluZy52YWx1ZS50b1N0cmluZygpO1xyXG4gICAgICAgICAgICBsb2cuZGVidWcoJ0RldmljZUxvZy5zZXR0aW5nQ2hhbmdlZDogSVRFTVBFUl9VUkw9JyArICB0aGlzLklURU1QRVJfVVJMKTtcclxuICAgICAgICAgICAgdGhpcy5heGlvcyA9IHRoaXMuY3JlYXRlQXhpb3NJbnN0YW5jZSgpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgcHVibGljIGdldFN0YXRlKCk6IERldmljZVN0YXRlIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5zdGF0ZTtcclxuICAgIH1cclxuICAgIHB1YmxpYyBpc2xvZ2dpbmcoKTogYm9vbGVhbiB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMubG9nZ2luZztcclxuICAgIH1cclxuICAgIHB1YmxpYyBzdGFydExvZ2dpbmcoKTogdm9pZCB7XHJcbiAgICAgICAgbG9nLmRlYnVnKCdEZXZpY2VMb2cuc3RhcnRMb2dnaW5nJyk7XHJcbiAgICAgICAgdGhpcy5sb2dnaW5nID0gdHJ1ZTtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgc3RvcExvZ2dpbmcoKTogdm9pZCB7XHJcbiAgICAgICAgbG9nLmRlYnVnKCdEZXZpY2VMb2cuc3RvcExvZ2dpbmcnKTtcclxuICAgICAgICB0aGlzLmxvZ2dpbmcgPSBmYWxzZTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIG9uRGF0YVJlY2VpdmVkKGRhdGE6IERldmljZURhdGEpOiB2b2lkIHtcclxuICAgICAgICBpZiAodGhpcy5sb2dnaW5nKSB7XHJcblxyXG4gICAgICAgICAgICBjb25zdCBkaWZmID0gZGF0YS50aW1lc3RhbXAgLSB0aGlzLnRpbWVzdGFtcDtcclxuICAgICAgICAgICAgdGhpcy50aW1lc3RhbXAgPSBkYXRhLnRpbWVzdGFtcDtcclxuICAgICAgICAgICAgY29uc3QgZGV2aWNlTG9nOiBEZXZpY2VEYXRhTG9nID0ge2RhdGF9O1xyXG4gICAgICAgICAgICBjb25zdCB1cmwgPSAnL3N0YXR1cyc7XHJcbiAgICAgICAgICAgIGxvZy5kZWJ1ZygnRGV2aWNlTG9nLm9uRGF0YVJlY2VpdmVkLCBVUkw6ICcgKyB1cmwpO1xyXG5cclxuICAgICAgICAgICAgY29uc3QgQXV0aG9yaXphdGlvbiA9ICdCZWFyZXIgJyArIHRoaXMuU0hBUkVEX0FDQ0VTU19LRVk7XHJcbiAgICAgICAgICAgIHRoaXMuYXhpb3MucG9zdDxEZXZpY2VEYXRhTG9nPih1cmwsIGRldmljZUxvZywge2hlYWRlcnM6IHsgQXV0aG9yaXphdGlvbiB9fSlcclxuICAgICAgICAgICAgLnRoZW4gKGZ1bmN0aW9uKHJlcykge1xyXG4gICAgICAgICAgICAgICAgbG9nLmluZm8oJ0RldmljZUxvZy5vbkRhdGFSZWNlaXZlZCwgcG9zdCAnICsgdXJsICsgJyAnICsgcmVzLnN0YXR1c1RleHQgK1xyXG4gICAgICAgICAgICAgICAgICAgICcgcmVzLmRhdGE6ICcgKyBKU09OLnN0cmluZ2lmeShkZXZpY2VMb2cpICsgJyBtczogJyArIGRpZmYgK1xyXG4gICAgICAgICAgICAgICAgICAgICcgZGF0ZTogJyArIG5ldyBEYXRlKGRhdGEudGltZXN0YW1wLnRvTG9jYWxlU3RyaW5nKCkpKTtcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgLmNhdGNoKGZ1bmN0aW9uKGVycm9yOiBBeGlvc0Vycm9yKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoZXJyb3IucmVzcG9uc2UpIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyBUaGUgcmVxdWVzdCB3YXMgbWFkZSBhbmQgdGhlIHNlcnZlciByZXNwb25kZWQgd2l0aCBhIHN0YXR1cyBjb2RlXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gdGhhdCBmYWxscyBvdXQgb2YgdGhlIHJhbmdlIG9mIDJ4eFxyXG4gICAgICAgICAgICAgICAgICAgIGxvZy5kZWJ1ZygnRGV2aWNlTG9nLm9uRGF0YVJlY2VpdmVkOicgKyAgZXJyb3IucmVzcG9uc2Uuc3RhdHVzICsgJyAtICcgK1xyXG4gICAgICAgICAgICAgICAgICAgIEpTT04uc3RyaW5naWZ5KGVycm9yLnJlc3BvbnNlLmRhdGEpKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZXJyb3IucmVxdWVzdCkge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIFRoZSByZXF1ZXN0IHdhcyBtYWRlIGJ1dCBubyByZXNwb25zZSB3YXMgcmVjZWl2ZWRcclxuICAgICAgICAgICAgICAgICAgICBsb2cuZXJyb3IoJ0RldmljZUxvZy5vbkRhdGFSZWNlaXZlZCwgcmVxdWVzdCwgbm8gcmVzcG9uc2U6JyArIGVycm9yLnJlcXVlc3QpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyBTb21ldGhpbmcgaGFwcGVuZWQgaW4gc2V0dGluZyB1cCB0aGUgcmVxdWVzdCB0aGF0IHRyaWdnZXJlZCBhbiBFcnJvclxyXG4gICAgICAgICAgICAgICAgICAgIGxvZy5lcnJvcignRGV2aWNlTG9nLm9uRGF0YVJlY2VpdmVkLCAgZXJyb3IuY29uZmlnOicgKyBlcnJvci5jb25maWcpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcbiJdfQ==
